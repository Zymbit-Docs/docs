<div class="section-index">
  {{ $parent := .Page }}
  {{ $pages := .Site.RegularPages.ByWeight }}
  {{ $pages = where $pages "Type" "!=" "search" }}
  {{ $pages = where $pages ".Params.hide_summary" "!=" true }}
  {{ $pages = where $pages ".Parent" "!=" nil }}
  {{ $pages = where $pages "Parent" "eq" $parent }}

  {{ if or $parent.Params.no_list (eq (len $pages) 0) }}
    {{/* nothing to list */}}
  {{ else if $parent.Params.simple_list }}
    <ul>
      {{ range $pages }}
        {{ $manualLink := cond (isset .Params "manuallink") .Params.manualLink (cond (isset .Params "manuallinkrelref") (relref . .Params.manualLinkRelref) .RelPermalink) }}
        <li><a href="{{ $manualLink }}"{{ with .Params.manualLinkTitle }} title="{{ . }}"{{ end }}{{ with .Params.manualLinkTarget }} target="{{ . }}"{{ if eq . "_blank" }} rel="noopener"{{ end }}{{ end }}>{{- .Title -}}</a></li>
      {{ end }}
    </ul>
  {{ else }}
    <hr class="panel-line">
    {{ range $pages }}
      {{ $manualLink := cond (isset .Params "manuallink") .Params.manualLink (cond (isset .Params "manuallinkrelref") (relref . .Params.manualLinkRelref) .RelPermalink) }}
      <div class="entry">
        <h5>
          <a href="{{ $manualLink }}"{{ with .Params.manualLinkTitle }} title="{{ . }}"{{ end }}{{ with .Params.manualLinkTarget }} target="{{ . }}"{{ if eq . "_blank" }} rel="noopener"{{ end }}{{ end }}>{{- .Title -}}</a>
        </h5>
        <p>{{ .Description | markdownify }}</p>
      </div>
    {{ end }}
  {{ end }}
</div>

