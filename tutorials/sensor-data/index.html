<!doctype html><html lang=en class=no-js>
<head>
<meta charset=utf-8>
<meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no">
<meta name=generator content="Hugo 0.91.1"><meta name=ROBOTS content="INDEX, FOLLOW">
<link rel="shortcut icon" href=/favicons/favicon.ico>
<link rel=apple-touch-icon href=/favicons/apple-touch-icon.png sizes=180x180>
<link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16>
<link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32>
<link rel=icon type=image/png href=/favicons/android-chrome-192x192.png sizes=192x192>
<link rel=icon type=image/png href=/favicons/android-chrome-512x512.png sizes=512x512>
<title>Encrypting & Decrypting Sensor Data on Disk | </title>
<meta name=description content="Why do this?
If you are just getting started with HSM you may want to start by encrypting some data to disk. This would be useful if you are …">
<meta property="og:title" content="Encrypting & Decrypting Sensor Data on Disk">
<meta property="og:description" content="Why do this? If you are just getting started with HSM you may want to start by encrypting some data to disk. This would be useful if you are collecting data to be read/analyzed at later time; and you do not want to store your data ‘in the clear’.
Encrypting data on disk prevents a bad actor from imaging your SD card and gaining access to sensitive data that is being stored in the field.">
<meta property="og:type" content="article">
<meta property="og:url" content="https://docs.zymbit.com/tutorials/sensor-data/"><meta property="og:image" content="https://docs.zymbit.com/doks.png"><meta property="article:section" content="tutorials">
<meta property="article:modified_time" content="2021-11-07T14:19:14-08:00"><meta property="og:site_name" content="Zymbit Documentation">
<meta itemprop=name content="Encrypting & Decrypting Sensor Data on Disk">
<meta itemprop=description content="Why do this? If you are just getting started with HSM you may want to start by encrypting some data to disk. This would be useful if you are collecting data to be read/analyzed at later time; and you do not want to store your data ‘in the clear’.
Encrypting data on disk prevents a bad actor from imaging your SD card and gaining access to sensitive data that is being stored in the field.">
<meta itemprop=dateModified content="2021-11-07T14:19:14-08:00">
<meta itemprop=wordCount content="821"><meta itemprop=image content="https://docs.zymbit.com/doks.png">
<meta itemprop=keywords content><meta name=twitter:card content="summary_large_image">
<meta name=twitter:image content="https://docs.zymbit.com/doks.png">
<meta name=twitter:title content="Encrypting & Decrypting Sensor Data on Disk">
<meta name=twitter:description content="Why do this? If you are just getting started with HSM you may want to start by encrypting some data to disk. This would be useful if you are collecting data to be read/analyzed at later time; and you do not want to store your data ‘in the clear’.
Encrypting data on disk prevents a bad actor from imaging your SD card and gaining access to sensitive data that is being stored in the field.">
<link rel=preload href=/scss/main.min.874b26b473cb7a1e419be33bf4a26faf0fd5ae3733989c5d2c9ab928a11b409d.css as=style>
<link href=/scss/main.min.874b26b473cb7a1e419be33bf4a26faf0fd5ae3733989c5d2c9ab928a11b409d.css rel=stylesheet integrity>
<script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script>
</head>
<body class=td-page>
<header>
<nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar">
<a class=navbar-brand href=/>
<img class=navbar-logo src=https://docs.zymbit.com/Zymbit-Logo.gif>
</a>
<div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar>
<ul class="navbar-nav mt-2 mt-lg-0">
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=https://community.zymbit.com/ target=_blank><i class="fab fa-discourse"></i><span>Community</span></a>
</li>
<li class="nav-item mr-4 mb-2 mb-lg-0">
<a class=nav-link href=https://github.com/zymbit-docs target=_blank><i class="fab fa-github"></i><span>GitHub</span></a>
</li>
</ul>
</div>
<div class="navbar-nav d-none d-lg-block"></div>
</nav>
</header>
<div class="container-fluid td-outer">
<div class=td-main>
<div class="row flex-xl-nowrap">
<aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none">
<div id=td-sidebar-menu class=td-sidebar__inner>
<form class="td-sidebar__search d-flex align-items-center">
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation">
</button>
</form>
<nav class="collapse td-sidebar-nav foldable-nav" id=td-section-nav>
<ul class="td-sidebar-nav__section pr-md-3 ul-0 fa-ul">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m--li>
<a href=/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section tree-root" id=m-><span class=fa-li><i class=nav-open-tree></i></span><span>Zymbit Documentation</span></a>
<ul class="pr-md-3 ul-1">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-getting-started-li>
<input type=checkbox id=m-getting-started-check checked>
<label for=m-getting-started-check><a href=/getting-started/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-getting-started><span class=td-sidebar-link__section>Getting Started</span></a></label>
<ul class="pr-md-3 ul-2 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-getting-startedzymkey4-li>
<input type=checkbox id=m-getting-startedzymkey4-check>
<label for=m-getting-startedzymkey4-check><span class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-getting-startedzymkey4><span class=td-sidebar-link__section>ZYMKEY4</span></span></label>
<ul class="pr-md-3 ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-getting-startedzymkey4quickstart-li>
<input type=checkbox id=m-getting-startedzymkey4quickstart-check>
<label for=m-getting-startedzymkey4quickstart-check><a href=/getting-started/zymkey4/quickstart/ title="Zymkey4 Quickstart" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-getting-startedzymkey4quickstart><span class=td-sidebar-link__page>Quickstart</span></a></label>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-getting-startedzymkey4production-mode-li>
<input type=checkbox id=m-getting-startedzymkey4production-mode-check>
<label for=m-getting-startedzymkey4production-mode-check><a href=/getting-started/zymkey4/production-mode/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-getting-startedzymkey4production-mode><span class=td-sidebar-link__page>Enabling Production Mode</span></a></label>
</li>
</ul>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-getting-startedhsm4-li>
<input type=checkbox id=m-getting-startedhsm4-check>
<label for=m-getting-startedhsm4-check><span class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-getting-startedhsm4><span class=td-sidebar-link__section>HSM4</span></span></label>
<ul class="pr-md-3 ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-getting-startedhsm4quickstart-li>
<input type=checkbox id=m-getting-startedhsm4quickstart-check>
<label for=m-getting-startedhsm4quickstart-check><a href=/getting-started/hsm4/quickstart/ title="Getting Started with HSM4" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-getting-startedhsm4quickstart><span class=td-sidebar-link__page>Quickstart</span></a></label>
</li>
</ul>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-getting-startedhsm6-li>
<input type=checkbox id=m-getting-startedhsm6-check>
<label for=m-getting-startedhsm6-check><span class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-getting-startedhsm6><span class=td-sidebar-link__section>HSM6</span></span></label>
<ul class="pr-md-3 ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-getting-startedhsm6quickstart-li>
<input type=checkbox id=m-getting-startedhsm6quickstart-check>
<label for=m-getting-startedhsm6quickstart-check><a href=/getting-started/hsm6/quickstart/ title="Getting Started with HSM6" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-getting-startedhsm6quickstart><span class=td-sidebar-link__page>Quickstart</span></a></label>
</li>
</ul>
</li>
</ul>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-api-li>
<input type=checkbox id=m-api-check checked>
<label for=m-api-check><a href=/api/ title="API Documentation" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-api><span class=td-sidebar-link__section>API</span></a></label>
<ul class="pr-md-3 ul-2 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-apic_api-li>
<input type=checkbox id=m-apic_api-check>
<label for=m-apic_api-check><a href=/api/c_api/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-apic_api><span class=td-sidebar-link__page>C API Documentation</span></a></label>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-apicpp_api-li>
<input type=checkbox id=m-apicpp_api-check>
<label for=m-apicpp_api-check><a href=/api/cpp_api/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-apicpp_api><span class=td-sidebar-link__page>C++ API Documentation</span></a></label>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-apipython_api-li>
<input type=checkbox id=m-apipython_api-check>
<label for=m-apipython_api-check><a href=/api/python_api/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-apipython_api><span class=td-sidebar-link__page>Python API Documentation</span></a></label>
</li>
</ul>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-troubleshooting-li>
<input type=checkbox id=m-troubleshooting-check checked>
<label for=m-troubleshooting-check><a href=/troubleshooting/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-troubleshooting><span class=td-sidebar-link__section>FAQ and Troubleshooting</span></a></label>
<ul class="pr-md-3 ul-2 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-troubleshootinggeneral-li>
<input type=checkbox id=m-troubleshootinggeneral-check>
<label for=m-troubleshootinggeneral-check><a href=/troubleshooting/general/ title="General FAQ & Troubleshooting" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-troubleshootinggeneral><span class=td-sidebar-link__page>General</span></a></label>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-troubleshootingzymkey4-li>
<input type=checkbox id=m-troubleshootingzymkey4-check>
<label for=m-troubleshootingzymkey4-check><a href=/troubleshooting/zymkey4/ title="ZYMKEY4 FAQ & Troubleshooting" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-troubleshootingzymkey4><span class=td-sidebar-link__page>ZYMKEY4</span></a></label>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-troubleshootinghsm4-li>
<input type=checkbox id=m-troubleshootinghsm4-check>
<label for=m-troubleshootinghsm4-check><a href=/troubleshooting/hsm4/ title="HSM4 FAQ & Troubleshooting" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-troubleshootinghsm4><span class=td-sidebar-link__page>HSM4</span></a></label>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-troubleshootinghsm6-li>
<input type=checkbox id=m-troubleshootinghsm6-check>
<label for=m-troubleshootinghsm6-check><a href=/troubleshooting/hsm6/ title="HSM6 FAQ & Troubleshooting" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-troubleshootinghsm6><span class=td-sidebar-link__page>HSM6</span></a></label>
</li>
</ul>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-reference-li>
<input type=checkbox id=m-reference-check checked>
<label for=m-reference-check><a href=/reference/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-reference><span class=td-sidebar-link__section>Reference</span></a></label>
<ul class="pr-md-3 ul-2 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-referenceproduct-briefs-li>
<input type=checkbox id=m-referenceproduct-briefs-check>
<label for=m-referenceproduct-briefs-check><a href=/reference/product-briefs/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-referenceproduct-briefs><span class=td-sidebar-link__section>Product Briefs</span></a></label>
<ul class="pr-md-3 ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referenceproduct-briefszymkey4-li>
<input type=checkbox id=m-referenceproduct-briefszymkey4-check>
<label for=m-referenceproduct-briefszymkey4-check><a href=https://www.zymbit.com/datasheets/zymkey-4i title target=_blank rel=noopener class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referenceproduct-briefszymkey4><span class=td-sidebar-link__page>ZYMKEY4</span></a></label>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referenceproduct-briefshsm4-li>
<input type=checkbox id=m-referenceproduct-briefshsm4-check>
<label for=m-referenceproduct-briefshsm4-check><a href=https://www.zymbit.com/datasheets/hsm4 title target=_blank rel=noopener class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referenceproduct-briefshsm4><span class=td-sidebar-link__page>HSM4</span></a></label>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referenceproduct-briefshsm6-li>
<input type=checkbox id=m-referenceproduct-briefshsm6-check>
<label for=m-referenceproduct-briefshsm6-check><a href=https://www.zymbit.com/datasheets/hsm6 title target=_blank rel=noopener class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referenceproduct-briefshsm6><span class=td-sidebar-link__page>HSM6</span></a></label>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referenceproduct-briefsmfg-app-li>
<input type=checkbox id=m-referenceproduct-briefsmfg-app-check>
<label for=m-referenceproduct-briefsmfg-app-check><a href=https://www.zymbit.com/datasheets/manufacturing-appliance-1 title target=_blank rel=noopener class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referenceproduct-briefsmfg-app><span class=td-sidebar-link__page>Manufacturing Appliance</span></a></label>
</li>
</ul>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-referencecad-li>
<input type=checkbox id=m-referencecad-check>
<label for=m-referencecad-check><a href=/reference/cad/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-referencecad><span class=td-sidebar-link__section>CAD Files</span></a></label>
<ul class="pr-md-3 ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencecadzymkey4-li>
<input type=checkbox id=m-referencecadzymkey4-check>
<label for=m-referencecadzymkey4-check><a href=/reference/cad/zymkey4/ title="Zymkey4 CAD Files" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referencecadzymkey4><span class=td-sidebar-link__page>ZYMKEY4</span></a></label>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencecadhsm4-li>
<input type=checkbox id=m-referencecadhsm4-check>
<label for=m-referencecadhsm4-check><a href=/reference/cad/hsm4/ title="HSM4 CAD Files" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referencecadhsm4><span class=td-sidebar-link__page>HSM4</span></a></label>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencecadhsm6-li>
<input type=checkbox id=m-referencecadhsm6-check>
<label for=m-referencecadhsm6-check><a href=/reference/cad/hsm6/ title="HSM6 CAD Files" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referencecadhsm6><span class=td-sidebar-link__page>HSM6</span></a></label>
</li>
</ul>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-referenceconformity-li>
<input type=checkbox id=m-referenceconformity-check>
<label for=m-referenceconformity-check><a href=/reference/conformity/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-referenceconformity><span class=td-sidebar-link__section>Conformity Documents</span></a></label>
<ul class="pr-md-3 ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referenceconformityzymkey4-li>
<input type=checkbox id=m-referenceconformityzymkey4-check>
<label for=m-referenceconformityzymkey4-check><a href=/reference/conformity/zymkey4/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referenceconformityzymkey4><span class=td-sidebar-link__page>Zymkey4 Conformity Documents</span></a></label>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referenceconformityhsm4-li>
<input type=checkbox id=m-referenceconformityhsm4-check>
<label for=m-referenceconformityhsm4-check><a href=/reference/conformity/hsm4/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referenceconformityhsm4><span class=td-sidebar-link__page>HSM4 Conformity Documents</span></a></label>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referenceconformityhsm6-li>
<input type=checkbox id=m-referenceconformityhsm6-check>
<label for=m-referenceconformityhsm6-check><a href=/reference/conformity/hsm6/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referenceconformityhsm6><span class=td-sidebar-link__page>HSM6 Conformity Documents</span></a></label>
</li>
</ul>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencepower-quality-li>
<input type=checkbox id=m-referencepower-quality-check>
<label for=m-referencepower-quality-check><a href=/reference/power-quality/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referencepower-quality><span class=td-sidebar-link__page>Power Quality Considerations</span></a></label>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencebinding-li>
<input type=checkbox id=m-referencebinding-check>
<label for=m-referencebinding-check><a href=/reference/binding/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referencebinding><span class=td-sidebar-link__page>Binding, Device ID, and Authentication</span></a></label>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencecpu-scaling-li>
<input type=checkbox id=m-referencecpu-scaling-check>
<label for=m-referencecpu-scaling-check><a href=/reference/cpu-scaling/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referencecpu-scaling><span class=td-sidebar-link__page>CPU Scaling Governor</span></a></label>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencereal-time-clock-li>
<input type=checkbox id=m-referencereal-time-clock-check>
<label for=m-referencereal-time-clock-check><a href=/reference/real-time-clock/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referencereal-time-clock><span class=td-sidebar-link__page>Real Time Clock Operation</span></a></label>
</li>
</ul>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-tutorials-li>
<input type=checkbox id=m-tutorials-check checked>
<label for=m-tutorials-check><a href=/tutorials/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-tutorials><span class=td-sidebar-link__section>Tutorials</span></a></label>
<ul class="pr-md-3 ul-2 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsalternative-gpio-li>
<input type=checkbox id=m-tutorialsalternative-gpio-check>
<label for=m-tutorialsalternative-gpio-check><a href=/tutorials/alternative-gpio/ title="Using an Alternative GPIO Pin" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsalternative-gpio><span class=td-sidebar-link__page>Alternative GPIO Pin</span></a></label>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsdigital-wallet-li>
<input type=checkbox id=m-tutorialsdigital-wallet-check>
<label for=m-tutorialsdigital-wallet-check><a href=/tutorials/digital-wallet/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsdigital-wallet><span class=td-sidebar-link__page>Digital Wallet</span></a></label>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsencrypt-rfs-li>
<input type=checkbox id=m-tutorialsencrypt-rfs-check>
<label for=m-tutorialsencrypt-rfs-check><a href=/tutorials/encrypt-rfs/ title="Encrypting Root File System with Zymbit Security Modules" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsencrypt-rfs><span class=td-sidebar-link__page>Encrypt Root File System</span></a></label>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child active-path" id=m-tutorialssensor-data-li>
<input type=checkbox id=m-tutorialssensor-data-check checked>
<label for=m-tutorialssensor-data-check><a href=/tutorials/sensor-data/ title="Encrypting & Decrypting Sensor Data on Disk" class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-tutorialssensor-data><span class="td-sidebar-nav-active-item td-sidebar-link__page">Encrypt Sensor Data</span></a></label>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-tutorialsaws-iot-li>
<input type=checkbox id=m-tutorialsaws-iot-check>
<label for=m-tutorialsaws-iot-check><a href=/tutorials/aws-iot/ title="AWS IoT Integrations & Client Certificates" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-tutorialsaws-iot><span class=td-sidebar-link__section>Integrate Zymbit with AWS</span></a></label>
<ul class="pr-md-3 ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsaws-iotintegrate-li>
<input type=checkbox id=m-tutorialsaws-iotintegrate-check>
<label for=m-tutorialsaws-iotintegrate-check><a href=/tutorials/aws-iot/integrate/ title="How to Integrate Zymbit with AWS Credentials Provider" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsaws-iotintegrate><span class=td-sidebar-link__page>Integrate with AWS Credentials Provider</span></a></label>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsaws-iotjitr-li>
<input type=checkbox id=m-tutorialsaws-iotjitr-check>
<label for=m-tutorialsaws-iotjitr-check><a href=/tutorials/aws-iot/jitr/ title="AWS IoT - Just in Time Registration of Client Certificates using Lambda functions" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsaws-iotjitr><span class=td-sidebar-link__page>Just In Time Registration</span></a></label>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsaws-iottls-li>
<input type=checkbox id=m-tutorialsaws-iottls-check>
<label for=m-tutorialsaws-iottls-check><a href=/tutorials/aws-iot/tls/ title="AWS IoT - TLS Client Certificate Authentication" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsaws-iottls><span class=td-sidebar-link__page>Transport Level Security</span></a></label>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsaws-iotverify-sigs-li>
<input type=checkbox id=m-tutorialsaws-iotverify-sigs-check>
<label for=m-tutorialsaws-iotverify-sigs-check><a href=/tutorials/aws-iot/verify-sigs/ title="How to Verify Signatures against Public Key on AWS and Other Devices" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsaws-iotverify-sigs><span class=td-sidebar-link__page>Verify Signatures</span></a></label>
</li>
</ul>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-tutorialsperimeter-detect-li>
<input type=checkbox id=m-tutorialsperimeter-detect-check>
<label for=m-tutorialsperimeter-detect-check><a href=/tutorials/perimeter-detect/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-tutorialsperimeter-detect><span class=td-sidebar-link__section>Perimeter Detect</span></a></label>
<ul class="pr-md-3 ul-3 foldable">
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsperimeter-detectzymkey4-li>
<input type=checkbox id=m-tutorialsperimeter-detectzymkey4-check>
<label for=m-tutorialsperimeter-detectzymkey4-check><a href=/tutorials/perimeter-detect/zymkey4/ title="Perimeter Detect: ZYMKEY4" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsperimeter-detectzymkey4><span class=td-sidebar-link__page>ZYMKEY4</span></a></label>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsperimeter-detecthsm4-li>
<input type=checkbox id=m-tutorialsperimeter-detecthsm4-check>
<label for=m-tutorialsperimeter-detecthsm4-check><a href=/tutorials/perimeter-detect/hsm4/ title="Perimeter Detect: HSM4" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsperimeter-detecthsm4><span class=td-sidebar-link__page>HSM4</span></a></label>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsperimeter-detecthsm6-li>
<input type=checkbox id=m-tutorialsperimeter-detecthsm6-check>
<label for=m-tutorialsperimeter-detecthsm6-check><a href=/tutorials/perimeter-detect/hsm6/ title="Perimeter Detect: HSM6" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsperimeter-detecthsm6><span class=td-sidebar-link__page>HSM6</span></a></label>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsperimeter-detectexamples-li>
<input type=checkbox id=m-tutorialsperimeter-detectexamples-check>
<label for=m-tutorialsperimeter-detectexamples-check><a href=/tutorials/perimeter-detect/examples/ title="Perimeter Detect Circuit Examples" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsperimeter-detectexamples><span class=td-sidebar-link__page>CIRCUIT EXAMPLES</span></a></label>
</li>
</ul>
</li>
<li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsprotokit-li>
<input type=checkbox id=m-tutorialsprotokit-check>
<label for=m-tutorialsprotokit-check><a href=/tutorials/protokit/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsprotokit><span class=td-sidebar-link__page>ProtoKit5</span></a></label>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</nav>
</div>
</aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none">
<div class="td-page-meta ml-2 pb-1 pt-2 mb-0">
</div>
<div class=td-toc><nav id=TableOfContents>
<ul>
<li><a href=#why-do-this>Why do this?</a></li>
<li><a href=#encrypting-data-blobs>Encrypting Data Blobs</a></li>
<li><a href=#what-you-will-need>What you will need</a></li>
<li><a href=#locking-data>Locking Data</a></li>
<li><a href=#unlocking-data>Unlocking Data</a></li>
<li><a href=#troubleshooting>Troubleshooting</a></li>
</ul>
</nav></div>
</aside><main class="col-12 col-md-8 col-xl-7 pl-md-5" role=main>
<nav aria-label=breadcrumb class="d-none d-md-block d-print-none">
<ol class="breadcrumb spb-1">
<li class=breadcrumb-item>
<a href=https://docs.zymbit.com/tutorials/>Tutorials</a>
</li>
<li class="breadcrumb-item active" aria-current=page>
<a href=https://docs.zymbit.com/tutorials/sensor-data/>Encrypt Sensor Data</a>
</li>
</ol>
</nav>
<div class=td-content>
<h1>Encrypting & Decrypting Sensor Data on Disk</h1>
<header class=article-meta>
</header>
<h2 id=why-do-this>Why do this?</h2>
<p>If you are just getting started with HSM you may want to start by encrypting some data to disk. This would be useful if you are collecting data to be read/analyzed at later time; and you do not want to store your data ‘in the clear’.</p>
<p>Encrypting data on disk prevents a bad actor from imaging your SD card and gaining access to sensitive data that is being stored in the field. If bad actor were to successfully image the card, data would remain encrypted and locked with your HSM&rsquo;s private key. If the HSM was also removed, then the bad actor would still not be able to access the data because each specific HSM is bound to a specific host hardware. Moving a specific HSM to another host hardware would fail the binding process and HSM would not perform any crypto functions, including decryption of data blobs.</p>
<h2 id=encrypting-data-blobs>Encrypting Data Blobs</h2>
<p>The process we describe here can also be used more generally to encrypt binary large objects, or ‘data blobs’</p>
<h2 id=what-you-will-need>What you will need</h2>
<p>If you have not already setup and bound your HSM please visit the <a href=https://docs.zymbit.com/getting-started/>Getting Started</a> page.</p>
<p>We will use temperature data from a DS18B20 OneWire probe. We will encrypt the data to disk using the HSM python package, and then decrypt in a different session. For the purpose of this tutorial I will not be going over the circuit setup and one-wire configuration. That is adequately covered <a href=https://learn.adafruit.com/adafruits-raspberry-pi-lesson-11-ds18b20-temperature-sensing/hardware>here. </a> If you have questions however, we are happy to help!</p>
<p>The process is very simple:</p>
<ol>
<li>Collect Measurements</li>
<li>Encrypt data with HSM</li>
<li>Safely store data locally</li>
<li>Decrypt at a later time with HSM.</li>
</ol>
<h2 id=locking-data>Locking Data</h2>
<p>Below is a sample script you can use to encrypt sensor data. Most of the code is for data acquisition, not encryption. For the most part, we are only interested in the lines toward the bottom using <code>zymkey.client</code> .</p>
<pre tabindex=0><code>import base64
import time
import zymkey
import datetime
import logging
import argparse
import subprocess as sub


class TempRead(object):
    def __init__(self):
        self.base_dir = '/sys/bus/w1/devices/'

    def probe_scan(self):
        devices_raw = sub.check_output(['ls', self.base_dir])
        devices = []
        for i in range(0, len(devices_raw)-3):
            if devices_raw[i:i+3] == '28-':
                devices.append(devices_raw[i:i+15])

        return devices

    def read_temp_raw(self, probe):
        f = open(self.base_dir+probe+'/w1_slave', 'r')
        lines = f.readlines()
        f.close()
        return lines

    def read_temp(self, probe):
        lines = self.read_temp_raw(probe)

        while lines[0].strip()[-3:] != 'YES':
            time.sleep(0.2)
            lines = self.read_temp_raw(probe)
        equals_pos = lines[1].find('t=')

        if equals_pos != -1:
            temp_string = lines[1][equals_pos+2:]
            c = round(float(temp_string) / 1000, 1)
            f = round(float(c * 9 / 5 + 32), 1)
            return c, f

if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument('--loglevel', '-l', default='debug')
    parser.add_argument('--file_out', '-fo', type=str, default='/tmp/encrypted.bin')
    parser.add_argument('--zymkey', action='store_true', default=False)
    parser.add_argument('--sleep', type=float, default=20)

    parser.set_defaults()
    args = parser.parse_args()

    logging.basicConfig(
        format=&quot;%(levelname)s:%(name)s:%(lineno)s:%(message)s&quot;,
        level=getattr(logging, args.loglevel.upper())
    )  # streams to sys.stderr by default

    temp = TempRead()
    probes = temp.probe_scan()

    encrypted_file = open(args.file_out, mode='wb')

    while True:
        for probe in probes:
            temp_c, temp_f = temp.read_temp(probe)
            payload = &quot;action=data, &quot; \
                &quot;key=temperature, &quot; \
                &quot;tags.unit=c, &quot; \
                &quot;tags.sensor_id={},&quot; \
                &quot;timestamp={}, &quot; \
                &quot;value= {}&quot;.format(str(&quot;ds18b20:&quot;+probe.replace(&quot;-&quot;, &quot;&quot;)),
                                   datetime.datetime.now().strftime('%Y-%m-%d %H:%M:%S'),
                                   temp_c)

            logging.debug('Unencrypted Payload: {}'.format(payload))

            if args.zymkey:
                logging.info('Encrypting data...')
                locked_data = zymkey.client.lock(bytearray(payload))
                encrypted_file.write(base64.b64encode(locked_data)+'\n')
                logging.debug('Encrypted DATA: {}'.format(locked_data))

        time.sleep(args.sleep)
</code></pre><p>The takeaways here are the <code>zymbit.client.lock</code> method and the flow of data types. Specifically, we want to lock a measurement of type <code>float</code> , the zymkey app utils library expects a <code>bytearray</code> , and the data needs to be <code>base64.encode</code> d so the blob can be written to a file on disk. This may sound like a lot but it can all be contained in two simple lines of code:</p>
<pre tabindex=0><code>locked_data = zymkey.client.lock(bytearray(payload))
encrypted_file.write(base64.b64encode(locked_data)+'\n')
</code></pre><p>See! HSM is super easy to use!</p>
<p>To see this in action copy this to your pi, save it as sensor_lock.py for consistency, and run the command:</p>
<p><code>python sensor_lock.py --zymkey --sleep=5</code></p>
<p>You should see encrypted data flowing and the new file <code>/tmp/encrypted.bin</code> , where your data is saved on disk.</p>
<h2 id=unlocking-data>Unlocking Data</h2>
<p>With the data we locked to disk above, lets unlock the data now so it is human and machine readable. A simple script such as the one pasted below will read the encrypted file, <code>decode</code> with base64, <code>unlock</code> with HSM and write to a <code>decrypted.txt</code> file so data is legible.</p>
<pre tabindex=0><code>import base64
import logging
import zymkey
import argparse

parser = argparse.ArgumentParser()
parser.add_argument('--loglevel', '-l', default='debug')
parser.add_argument('--file_in', '-fi', type=str, default='/tmp/encrypted.bin')
parser.add_argument('--file_out', '-fo', type=str, default='/tmp/decrypted.txt')

parser.set_defaults()

args = parser.parse_args()

logging.basicConfig(
    format=&quot;%(levelname)s:%(name)s:%(lineno)s:%(message)s&quot;,
    level=getattr(logging, args.loglevel.upper())
)  # streams to sys.stderr by default

with open(args.file_in) as f:
    logging.debug(&quot;Reading encrypted data from {}&quot;.format(args.file_in))
    content = f.readlines()

decrypted_file = open(args.file_out, mode='w+')

for i in content:
    payload = zymkey.client.unlock(bytearray(base64.b64decode(i)))
    logging.info(str(payload))
    logging.debug(&quot;Writing decrypted sensor data {} to {}&quot;.format(payload, args.file_out))
    decrypted_file.write(str(payload) + '\n')

decrypted_file.close()
</code></pre><p>Copy this to your Raspberry Pi, save as <code>sensor_unlock.py</code> and run as is with:</p>
<p><code>python sensor_unlock.py</code></p>
<p>Your data will be unlocked and saved to disk at <code>/tmp/decrypted.txt</code> . It should look something like this:</p>
<pre tabindex=0><code>action=data, key=temperature, tags.unit=c, tags.sensor_id=ds18b20:28000006151b77,timestamp=2016-12-13 22:55:02, value= 19.5
action=data, key=temperature, tags.unit=c, tags.sensor_id=ds18b20:280000061543fd,timestamp=2016-12-13 22:55:03, value= 19.6
action=data, key=temperature, tags.unit=c, tags.sensor_id=ds18b20:28000006156310,timestamp=2016-12-13 22:55:04, value= 19.3
action=data, key=temperature, tags.unit=c, tags.sensor_id=ds18b20:28000006e10735,
</code></pre><h2 id=troubleshooting>Troubleshooting</h2>
<p><a href=https://docs.zymbit.com/troubleshooting/>Troubleshooting</a><br>
<a href=https://community.zymbit.com/>Community</a></p>
</ul>
</div>
</main>
</div>
</div>
<footer class="bg-dark py-5 row d-print-none">
<div class="container-fluid mx-sm-5">
<div class=row>
<div class="col-6 col-sm-4 text-xs-center order-sm-2">
</div>
<div class="col-6 col-sm-4 text-right text-xs-center order-sm-3">
</div>
<div class="col-12 col-sm-4 text-center py-2 order-sm-2">
</div>
</div>
</div>
</footer>
</div>
<script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script>
<script src=/js/tabpane-persist.js></script>
<script src=/js/main.min.90117f987c53fd91c158b0fdafdd706a652142547bf4e69cdb0a9815070485f4.js integrity="sha256-kBF/mHxT/ZHBWLD9r91wamUhQlR79Oac2wqYFQcEhfQ=" crossorigin=anonymous></script>
</body>
</html>