<!doctype html><html lang=en class=no-js><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.122.0"><meta name=ROBOTS content="INDEX, FOLLOW"><link rel="shortcut icon" href=/favicons/favicon.ico><link rel=apple-touch-icon href=/favicons/apple-touch-icon.png sizes=180x180><link rel=icon type=image/png href=/favicons/favicon-16x16.png sizes=16x16><link rel=icon type=image/png href=/favicons/favicon-32x32.png sizes=32x32><link rel=icon type=image/png href=/favicons/android-chrome-192x192.png sizes=192x192><link rel=icon type=image/png href=/favicons/android-chrome-512x512.png sizes=512x512><title>How to Verify Signatures against Public Key on AWS and Other Devices | </title><meta name=description content="Introduction
While all Zymbit modules make it trivial to verify data signed on the device with that module, verifying
the signature of data on other …"><meta property="og:title" content="How to Verify Signatures against Public Key on AWS and Other Devices"><meta property="og:description" content="Introduction While all Zymbit modules make it trivial to verify data signed on the device with that module, verifying the signature of data on other devices using the exportable public key requires a little more explanation. Below is a simple code snippet to show how to verify the signature of data using Zymbit&rsquo;s Python API.
#!/usr/bin/python3 import zymkey # sign data data = 'hello world!' payload_sig = zymkey.client.sign(data) # verify signature matches encrypted data try: if zymkey."><meta property="og:type" content="article"><meta property="og:url" content="https://docs.zymbit.com/tutorials/aws-iot/verify-sigs/"><meta property="og:image" content="https://docs.zymbit.com/doks.png"><meta property="article:section" content="tutorials"><meta property="article:modified_time" content="2023-02-16T16:20:44-08:00"><meta property="og:site_name" content="Zymbit Documentation"><meta itemprop=name content="How to Verify Signatures against Public Key on AWS and Other Devices"><meta itemprop=description content="Introduction While all Zymbit modules make it trivial to verify data signed on the device with that module, verifying the signature of data on other devices using the exportable public key requires a little more explanation. Below is a simple code snippet to show how to verify the signature of data using Zymbit&rsquo;s Python API.
#!/usr/bin/python3 import zymkey # sign data data = 'hello world!' payload_sig = zymkey.client.sign(data) # verify signature matches encrypted data try: if zymkey."><meta itemprop=dateModified content="2023-02-16T16:20:44-08:00"><meta itemprop=wordCount content="2806"><meta itemprop=image content="https://docs.zymbit.com/doks.png"><meta itemprop=keywords content><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://docs.zymbit.com/doks.png"><meta name=twitter:title content="How to Verify Signatures against Public Key on AWS and Other Devices"><meta name=twitter:description content="Introduction While all Zymbit modules make it trivial to verify data signed on the device with that module, verifying the signature of data on other devices using the exportable public key requires a little more explanation. Below is a simple code snippet to show how to verify the signature of data using Zymbit&rsquo;s Python API.
#!/usr/bin/python3 import zymkey # sign data data = 'hello world!' payload_sig = zymkey.client.sign(data) # verify signature matches encrypted data try: if zymkey."><link rel=preload href=/scss/main.min.67b6b00bca6864cf5153909b7a58e2b18e24ec0397ca97400cf95bacffb3572c.css as=style><link href=/scss/main.min.67b6b00bca6864cf5153909b7a58e2b18e24ec0397ca97400cf95bacffb3572c.css rel=stylesheet integrity><script src=https://code.jquery.com/jquery-3.5.1.min.js integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin=anonymous></script><script src=https://unpkg.com/lunr@2.3.8/lunr.min.js integrity=sha384-vRQ9bDyE0Wnu+lMfm57BlYLO0/XauFuKpVsZPs7KEDwYKktWi5+Kz3MP8++DFlRY crossorigin=anonymous></script></head><body class=td-page><header><nav class="js-navbar-scroll navbar navbar-expand navbar-dark flex-column flex-md-row td-navbar"><a class=navbar-brand href=/><img class=navbar-logo src=https://docs.zymbit.com/Zymbit-Logo.gif></a><div class="td-navbar-nav-scroll ml-md-auto" id=main_navbar><ul class="navbar-nav mt-2 mt-lg-0"><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://community.zymbit.com/ target=_blank><i class="fab fa-discourse"></i><span>Community</span></a></li><li class="nav-item mr-4 mb-2 mb-lg-0"><a class=nav-link href=https://zymbit.com target=_blank><i class="fa fa-home"></i><span>zymbit.com</span></a></li></ul></div><div class="navbar-nav d-none d-lg-block"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.d8dd584e1135ba62a770e76aa0ebfeb8.json data-offline-search-base-href=/ data-offline-search-max-results=10></div></nav></header><div class="container-fluid td-outer"><div class=td-main><div class="row flex-xl-nowrap"><aside class="col-12 col-md-3 col-xl-2 td-sidebar d-print-none"><div id=td-sidebar-menu class=td-sidebar__inner><form class="td-sidebar__search d-flex align-items-center"><input type=search class="form-control td-search-input" placeholder="&#xf002; Search this site…" aria-label="Search this site…" autocomplete=off data-offline-search-index-json-src=/offline-search-index.d8dd584e1135ba62a770e76aa0ebfeb8.json data-offline-search-base-href=/ data-offline-search-max-results=10>
<button class="btn btn-link td-sidebar__toggle d-md-none p-0 ml-3 fas fa-bars" type=button data-toggle=collapse data-target=#td-section-nav aria-controls=td-docs-nav aria-expanded=false aria-label="Toggle section navigation"></button></form><nav class="collapse td-sidebar-nav foldable-nav" id=td-section-nav><ul class="td-sidebar-nav__section pr-md-3 ul-0 fa-ul"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m--li><a href=/ class="align-left pl-0 pr-2 td-sidebar-link td-sidebar-link__section tree-root" id=m-><span class=fa-li><i class=nav-open-tree></i></span><span>Zymbit Documentation</span></a><ul class="pr-md-3 ul-1"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-getting-started-li><input type=checkbox id=m-getting-started-check checked>
<label for=m-getting-started-check><a href=/getting-started/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-getting-started><span class=td-sidebar-link__section>Getting Started</span></a></label><ul class="pr-md-3 ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-getting-startedscm-li><input type=checkbox id=m-getting-startedscm-check>
<label for=m-getting-startedscm-check><span class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-getting-startedscm><span class=td-sidebar-link__section>Secure Compute Module - SCM</span></span></label><ul class="pr-md-3 ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-getting-startedscmquickstart-li><input type=checkbox id=m-getting-startedscmquickstart-check>
<label for=m-getting-startedscmquickstart-check><a href=/getting-started/scm/quickstart/ title="Quickstart - Secure Compute Module (SCM)" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-getting-startedscmquickstart><span class=td-sidebar-link__page>Quickstart</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-getting-startedscmproduction-mode-li><input type=checkbox id=m-getting-startedscmproduction-mode-check>
<label for=m-getting-startedscmproduction-mode-check><a href=/getting-started/scm/production-mode/ title="Enabling Production Mode - SCM" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-getting-startedscmproduction-mode><span class=td-sidebar-link__page>Enabling Production Mode</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-getting-startedscm-dev-kit3-li><input type=checkbox id=m-getting-startedscm-dev-kit3-check>
<label for=m-getting-startedscm-dev-kit3-check><span class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-getting-startedscm-dev-kit3><span class=td-sidebar-link__section>Secure Compute Module - Dev Kit 3</span></span></label><ul class="pr-md-3 ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-getting-startedscm-dev-kit3quickstart-li><input type=checkbox id=m-getting-startedscm-dev-kit3quickstart-check>
<label for=m-getting-startedscm-dev-kit3quickstart-check><a href=/getting-started/scm-dev-kit3/quickstart/ title="Quickstart - SCM Developer Kit 3" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-getting-startedscm-dev-kit3quickstart><span class=td-sidebar-link__page>Quickstart</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-getting-startedscm-dev-kit3production-mode-li><input type=checkbox id=m-getting-startedscm-dev-kit3production-mode-check>
<label for=m-getting-startedscm-dev-kit3production-mode-check><a href=/getting-started/scm-dev-kit3/production-mode/ title="Enabling Production Mode - SCM" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-getting-startedscm-dev-kit3production-mode><span class=td-sidebar-link__page>Enabling Production Mode</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-getting-startedscm-dev-kit2-li><input type=checkbox id=m-getting-startedscm-dev-kit2-check>
<label for=m-getting-startedscm-dev-kit2-check><span class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-getting-startedscm-dev-kit2><span class=td-sidebar-link__section>Secure Compute Module - Dev Kit 2</span></span></label><ul class="pr-md-3 ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-getting-startedscm-dev-kit2quickstart-li><input type=checkbox id=m-getting-startedscm-dev-kit2quickstart-check>
<label for=m-getting-startedscm-dev-kit2quickstart-check><a href=/getting-started/scm-dev-kit2/quickstart/ title="Quickstart - SCM Developer Kit 2" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-getting-startedscm-dev-kit2quickstart><span class=td-sidebar-link__page>Quickstart</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-getting-startedscm-dev-kit2production-mode-li><input type=checkbox id=m-getting-startedscm-dev-kit2production-mode-check>
<label for=m-getting-startedscm-dev-kit2production-mode-check><a href=/getting-started/scm-dev-kit2/production-mode/ title="Enabling Production Mode - SCM" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-getting-startedscm-dev-kit2production-mode><span class=td-sidebar-link__page>Enabling Production Mode</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-getting-startedsen-li><input type=checkbox id=m-getting-startedsen-check>
<label for=m-getting-startedsen-check><span class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-getting-startedsen><span class=td-sidebar-link__section>Secure Edge Node</span></span></label><ul class="pr-md-3 ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-getting-startedsenquickstart-li><input type=checkbox id=m-getting-startedsenquickstart-check>
<label for=m-getting-startedsenquickstart-check><a href=/getting-started/sen/quickstart/ title="Quickstart - Secure Edge Node" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-getting-startedsenquickstart><span class=td-sidebar-link__page>Quickstart</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-getting-startedsenproduction-mode-li><input type=checkbox id=m-getting-startedsenproduction-mode-check>
<label for=m-getting-startedsenproduction-mode-check><a href=/getting-started/sen/production-mode/ title="Enabling Production Mode - Secure Edge Node" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-getting-startedsenproduction-mode><span class=td-sidebar-link__page>Enabling Production Mode</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-getting-startedzymkey4-li><input type=checkbox id=m-getting-startedzymkey4-check>
<label for=m-getting-startedzymkey4-check><span class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-getting-startedzymkey4><span class=td-sidebar-link__section>ZYMKEY4</span></span></label><ul class="pr-md-3 ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-getting-startedzymkey4quickstart-li><input type=checkbox id=m-getting-startedzymkey4quickstart-check>
<label for=m-getting-startedzymkey4quickstart-check><a href=/getting-started/zymkey4/quickstart/ title="Quickstart - ZYMKEY4" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-getting-startedzymkey4quickstart><span class=td-sidebar-link__page>Quickstart</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-getting-startedzymkey4production-mode-li><input type=checkbox id=m-getting-startedzymkey4production-mode-check>
<label for=m-getting-startedzymkey4production-mode-check><a href=/getting-started/zymkey4/production-mode/ title="Enabling Production Mode - ZYMKEY4" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-getting-startedzymkey4production-mode><span class=td-sidebar-link__page>Enabling Production Mode</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-getting-startedhsm4-li><input type=checkbox id=m-getting-startedhsm4-check>
<label for=m-getting-startedhsm4-check><span class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-getting-startedhsm4><span class=td-sidebar-link__section>HSM4</span></span></label><ul class="pr-md-3 ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-getting-startedhsm4quickstart-li><input type=checkbox id=m-getting-startedhsm4quickstart-check>
<label for=m-getting-startedhsm4quickstart-check><a href=/getting-started/hsm4/quickstart/ title="Quickstart - HSM4" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-getting-startedhsm4quickstart><span class=td-sidebar-link__page>Quickstart</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-getting-startedhsm4production-mode-li><input type=checkbox id=m-getting-startedhsm4production-mode-check>
<label for=m-getting-startedhsm4production-mode-check><a href=/getting-started/hsm4/production-mode/ title="Enabling Production Mode - HSM4" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-getting-startedhsm4production-mode><span class=td-sidebar-link__page>Enabling Production Mode</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-getting-startedhsm6-li><input type=checkbox id=m-getting-startedhsm6-check>
<label for=m-getting-startedhsm6-check><span class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-getting-startedhsm6><span class=td-sidebar-link__section>HSM6</span></span></label><ul class="pr-md-3 ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-getting-startedhsm6quickstart-li><input type=checkbox id=m-getting-startedhsm6quickstart-check>
<label for=m-getting-startedhsm6quickstart-check><a href=/getting-started/hsm6/quickstart/ title="Quickstart - HSM6" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-getting-startedhsm6quickstart><span class=td-sidebar-link__page>Quickstart</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-getting-startedhsm6production-mode-li><input type=checkbox id=m-getting-startedhsm6production-mode-check>
<label for=m-getting-startedhsm6production-mode-check><a href=/getting-started/hsm6/production-mode/ title="Enabling Production Mode - HSM6" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-getting-startedhsm6production-mode><span class=td-sidebar-link__page>Enabling Production Mode</span></a></label></li></ul></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-bootware-preview-li><input type=checkbox id=m-bootware-preview-check checked>
<label for=m-bootware-preview-check><a href=/bootware-preview/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-bootware-preview><span class=td-sidebar-link__section>Bootware Preview</span></a></label><ul class="pr-md-3 ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-bootware-previewerror-codes-li><input type=checkbox id=m-bootware-previewerror-codes-check>
<label for=m-bootware-previewerror-codes-check><a href=/bootware-preview/error-codes/ title="Bootware Error Codes" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-bootware-previewerror-codes><span class=td-sidebar-link__page>Logging and Bootware Error Codes</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-bootware-previewadditional-info-li><input type=checkbox id=m-bootware-previewadditional-info-check>
<label for=m-bootware-previewadditional-info-check><a href=/bootware-preview/additional-info/ title="Bootware Additional Info" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-bootware-previewadditional-info><span class=td-sidebar-link__page>Additional Bootware File Info</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-api-li><input type=checkbox id=m-api-check checked>
<label for=m-api-check><a href=/api/ title="API Documentation" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-api><span class=td-sidebar-link__section>API</span></a></label><ul class="pr-md-3 ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-apiapi_docs_intro-li><input type=checkbox id=m-apiapi_docs_intro-check>
<label for=m-apiapi_docs_intro-check><a href=/api/api_docs_intro/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-apiapi_docs_intro><span class=td-sidebar-link__page>Intro to Zymkey Application Utilities</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-apic_api-li><input type=checkbox id=m-apic_api-check>
<label for=m-apic_api-check><a href=/api/c_api/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-apic_api><span class=td-sidebar-link__page>C API Documentation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-apicpp_api-li><input type=checkbox id=m-apicpp_api-check>
<label for=m-apicpp_api-check><a href=/api/cpp_api/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-apicpp_api><span class=td-sidebar-link__page>C++ API Documentation</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-apipython_api-li><input type=checkbox id=m-apipython_api-check>
<label for=m-apipython_api-check><a href=/api/python_api/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-apipython_api><span class=td-sidebar-link__page>Python API Documentation</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-zymbit-wallet-sdk-li><input type=checkbox id=m-zymbit-wallet-sdk-check checked>
<label for=m-zymbit-wallet-sdk-check><a href=/zymbit-wallet-sdk/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-zymbit-wallet-sdk><span class=td-sidebar-link__section>Zymbit Wallet SDK</span></a></label><ul class="pr-md-3 ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-zymbit-wallet-sdkzymbit-wallet-sdk-py-li><input type=checkbox id=m-zymbit-wallet-sdkzymbit-wallet-sdk-py-check>
<label for=m-zymbit-wallet-sdkzymbit-wallet-sdk-py-check><a href=/zymbit-wallet-sdk/zymbit-wallet-sdk-py/ title="Zymbit Wallet Python SDK Documentation" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-zymbit-wallet-sdkzymbit-wallet-sdk-py><span class=td-sidebar-link__page>Zymbit Wallet Python SDK</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-troubleshooting-li><input type=checkbox id=m-troubleshooting-check checked>
<label for=m-troubleshooting-check><a href=/troubleshooting/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-troubleshooting><span class=td-sidebar-link__section>FAQ and Troubleshooting</span></a></label><ul class="pr-md-3 ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-troubleshootinggeneral-li><input type=checkbox id=m-troubleshootinggeneral-check>
<label for=m-troubleshootinggeneral-check><a href=/troubleshooting/general/ title="General FAQ & Troubleshooting" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-troubleshootinggeneral><span class=td-sidebar-link__page>General</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-troubleshootingscm-li><input type=checkbox id=m-troubleshootingscm-check>
<label for=m-troubleshootingscm-check><a href=/troubleshooting/scm/ title="SCM FAQ and Troubleshooting" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-troubleshootingscm><span class=td-sidebar-link__page>SCM</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-troubleshootingscm-mobo-li><input type=checkbox id=m-troubleshootingscm-mobo-check>
<label for=m-troubleshootingscm-mobo-check><a href=/troubleshooting/scm-mobo/ title="SCM Motherboard D35 FAQ and Troubleshooting" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-troubleshootingscm-mobo><span class=td-sidebar-link__page>SCM Motherboard D35</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-troubleshootingzymkey4-li><input type=checkbox id=m-troubleshootingzymkey4-check>
<label for=m-troubleshootingzymkey4-check><a href=/troubleshooting/zymkey4/ title="ZYMKEY4 FAQ & Troubleshooting" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-troubleshootingzymkey4><span class=td-sidebar-link__page>ZYMKEY4</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-troubleshootinghsm4-li><input type=checkbox id=m-troubleshootinghsm4-check>
<label for=m-troubleshootinghsm4-check><a href=/troubleshooting/hsm4/ title="HSM4 FAQ & Troubleshooting" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-troubleshootinghsm4><span class=td-sidebar-link__page>HSM4</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-troubleshootinghsm6-li><input type=checkbox id=m-troubleshootinghsm6-check>
<label for=m-troubleshootinghsm6-check><a href=/troubleshooting/hsm6/ title="HSM6 FAQ & Troubleshooting" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-troubleshootinghsm6><span class=td-sidebar-link__page>HSM6</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-reference-li><input type=checkbox id=m-reference-check checked>
<label for=m-reference-check><a href=/reference/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-reference><span class=td-sidebar-link__section>Reference</span></a></label><ul class="pr-md-3 ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-referenceproduct-briefs-li><input type=checkbox id=m-referenceproduct-briefs-check>
<label for=m-referenceproduct-briefs-check><a href=/reference/product-briefs/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-referenceproduct-briefs><span class=td-sidebar-link__section>Product Briefs</span></a></label><ul class="pr-md-3 ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referenceproduct-briefszymkey4-li><input type=checkbox id=m-referenceproduct-briefszymkey4-check>
<label for=m-referenceproduct-briefszymkey4-check><a href=https://www.zymbit.com/datasheets/zymkey-4i title target=_blank rel=noopener class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referenceproduct-briefszymkey4><span class=td-sidebar-link__page>ZYMKEY4</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referenceproduct-briefshsm4-li><input type=checkbox id=m-referenceproduct-briefshsm4-check>
<label for=m-referenceproduct-briefshsm4-check><a href=https://www.zymbit.com/datasheets/hsm4 title target=_blank rel=noopener class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referenceproduct-briefshsm4><span class=td-sidebar-link__page>HSM4</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referenceproduct-briefshsm6-li><input type=checkbox id=m-referenceproduct-briefshsm6-check>
<label for=m-referenceproduct-briefshsm6-check><a href=https://www.zymbit.com/datasheets/hsm6 title target=_blank rel=noopener class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referenceproduct-briefshsm6><span class=td-sidebar-link__page>HSM6</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referenceproduct-briefsmfg-app-li><input type=checkbox id=m-referenceproduct-briefsmfg-app-check>
<label for=m-referenceproduct-briefsmfg-app-check><a href=https://www.zymbit.com/datasheets/manufacturing-appliance-1 title target=_blank rel=noopener class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referenceproduct-briefsmfg-app><span class=td-sidebar-link__page>Manufacturing Appliance</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referenceproduct-briefsscm-li><input type=checkbox id=m-referenceproduct-briefsscm-check>
<label for=m-referenceproduct-briefsscm-check><a href=https://www.zymbit.com/scm/ title target=_blank rel=noopener class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referenceproduct-briefsscm><span class=td-sidebar-link__page>ZYMKEY4</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-referenceengineering-notes-li><input type=checkbox id=m-referenceengineering-notes-check>
<label for=m-referenceengineering-notes-check><a href=/reference/engineering-notes/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-referenceengineering-notes><span class=td-sidebar-link__section>Engineering Notes</span></a></label><ul class="pr-md-3 ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referenceengineering-notesen-20230721-scm-mobo-li><input type=checkbox id=m-referenceengineering-notesen-20230721-scm-mobo-check>
<label for=m-referenceengineering-notesen-20230721-scm-mobo-check><a href=./Zymbit-Engineering-Note-20230721-SCM-Motherboard-USB.pdf title target=_blank rel=noopener class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referenceengineering-notesen-20230721-scm-mobo><span class=td-sidebar-link__page>Engineering Note 20230721 SCM Motherboard - USB Power</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referenceengineering-notesen-20221011-hsm-perim-li><input type=checkbox id=m-referenceengineering-notesen-20221011-hsm-perim-check>
<label for=m-referenceengineering-notesen-20221011-hsm-perim-check><a href=./Zymbit-Engineering-Note-20221011-HSM-Using-Perim-Detect.pdf title target=_blank rel=noopener class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referenceengineering-notesen-20221011-hsm-perim><span class=td-sidebar-link__page>Engineering Note 20221011 HSM4/HSM6 - Using Perimeter Detect</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-referencecad-li><input type=checkbox id=m-referencecad-check>
<label for=m-referencecad-check><a href=/reference/cad/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-referencecad><span class=td-sidebar-link__section>CAD Files</span></a></label><ul class="pr-md-3 ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencecadzymkey4-li><input type=checkbox id=m-referencecadzymkey4-check>
<label for=m-referencecadzymkey4-check><a href=/reference/cad/zymkey4/ title=Zymkey4 class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referencecadzymkey4><span class=td-sidebar-link__page>ZYMKEY4</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencecadhsm4-li><input type=checkbox id=m-referencecadhsm4-check>
<label for=m-referencecadhsm4-check><a href=/reference/cad/hsm4/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referencecadhsm4><span class=td-sidebar-link__page>HSM4</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencecadhsm6-li><input type=checkbox id=m-referencecadhsm6-check>
<label for=m-referencecadhsm6-check><a href=/reference/cad/hsm6/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referencecadhsm6><span class=td-sidebar-link__page>HSM6</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencecadscm-li><input type=checkbox id=m-referencecadscm-check>
<label for=m-referencecadscm-check><a href=/reference/cad/scm/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referencecadscm><span class=td-sidebar-link__page>Secure Compute Module (SCM)</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencecaddeveloperkit2-li><input type=checkbox id=m-referencecaddeveloperkit2-check>
<label for=m-referencecaddeveloperkit2-check><a href=/reference/cad/developerkit2/ title="SCM Developer Kit 2 Assembly" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referencecaddeveloperkit2><span class=td-sidebar-link__page>Developer Kit (D35 I/O Board)</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-referenceconformity-li><input type=checkbox id=m-referenceconformity-check>
<label for=m-referenceconformity-check><a href=/reference/conformity/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-referenceconformity><span class=td-sidebar-link__section>Conformity Documents</span></a></label><ul class="pr-md-3 ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referenceconformityscm-li><input type=checkbox id=m-referenceconformityscm-check>
<label for=m-referenceconformityscm-check><a href=/reference/conformity/scm/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referenceconformityscm><span class=td-sidebar-link__page>Secure Compute Family Conformity Documents</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referenceconformityzymkey4-li><input type=checkbox id=m-referenceconformityzymkey4-check>
<label for=m-referenceconformityzymkey4-check><a href=/reference/conformity/zymkey4/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referenceconformityzymkey4><span class=td-sidebar-link__page>Zymkey4 Conformity Documents</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referenceconformityhsm4-li><input type=checkbox id=m-referenceconformityhsm4-check>
<label for=m-referenceconformityhsm4-check><a href=/reference/conformity/hsm4/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referenceconformityhsm4><span class=td-sidebar-link__page>HSM4 Conformity Documents</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referenceconformityhsm6-li><input type=checkbox id=m-referenceconformityhsm6-check>
<label for=m-referenceconformityhsm6-check><a href=/reference/conformity/hsm6/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referenceconformityhsm6><span class=td-sidebar-link__page>HSM6 Conformity Documents</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencepower-quality-li><input type=checkbox id=m-referencepower-quality-check>
<label for=m-referencepower-quality-check><a href=/reference/power-quality/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referencepower-quality><span class=td-sidebar-link__page>Power Quality Considerations</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencebinding-li><input type=checkbox id=m-referencebinding-check>
<label for=m-referencebinding-check><a href=/reference/binding/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referencebinding><span class=td-sidebar-link__page>Binding, Device ID, and Authentication</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencereserved-pins-li><input type=checkbox id=m-referencereserved-pins-check>
<label for=m-referencereserved-pins-check><a href=/reference/reserved-pins/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referencereserved-pins><span class=td-sidebar-link__page>SCM Reserved Pins</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencecpu-scaling-li><input type=checkbox id=m-referencecpu-scaling-check>
<label for=m-referencecpu-scaling-check><a href=/reference/cpu-scaling/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referencecpu-scaling><span class=td-sidebar-link__page>CPU Scaling Governor</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-referencereal-time-clock-li><input type=checkbox id=m-referencereal-time-clock-check>
<label for=m-referencereal-time-clock-check><a href=/reference/real-time-clock/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-referencereal-time-clock><span class=td-sidebar-link__page>Real Time Clock Operation</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-tutorials-li><input type=checkbox id=m-tutorials-check checked>
<label for=m-tutorials-check><a href=/tutorials/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-tutorials><span class=td-sidebar-link__section>Tutorials</span></a></label><ul class="pr-md-3 ul-2 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialssupervised-boot-li><input type=checkbox id=m-tutorialssupervised-boot-check>
<label for=m-tutorialssupervised-boot-check><a href=/tutorials/supervised-boot/ title="Working with SCM Supervised Boot" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialssupervised-boot><span class=td-sidebar-link__page>Supervised Boot (SCM)</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsalternative-gpio-li><input type=checkbox id=m-tutorialsalternative-gpio-check>
<label for=m-tutorialsalternative-gpio-check><a href=/tutorials/alternative-gpio/ title="Using an Alternative GPIO Pin" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsalternative-gpio><span class=td-sidebar-link__page>Alternative GPIO Pin</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-tutorialsdigital-wallet-li><input type=checkbox id=m-tutorialsdigital-wallet-check>
<label for=m-tutorialsdigital-wallet-check><a href=/tutorials/digital-wallet/ title="Zymbit Embedded Hardware Wallet" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-tutorialsdigital-wallet><span class=td-sidebar-link__section>Embedded Hardware Wallet</span></a></label><ul class="pr-md-3 ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsdigital-walletwallet-example-li><input type=checkbox id=m-tutorialsdigital-walletwallet-example-check>
<label for=m-tutorialsdigital-walletwallet-example-check><a href=/tutorials/digital-wallet/wallet-example/ title="Working with the Zymbit Hardware Wallet" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsdigital-walletwallet-example><span class=td-sidebar-link__page>Zymbit Hardware Wallet</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsdigital-walletzymbit-wallet-python-sdk-li><input type=checkbox id=m-tutorialsdigital-walletzymbit-wallet-python-sdk-check>
<label for=m-tutorialsdigital-walletzymbit-wallet-python-sdk-check><a href=/tutorials/digital-wallet/zymbit-wallet-python-sdk/ title="Working with Zymbit's Wallet Python SDK" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsdigital-walletzymbit-wallet-python-sdk><span class=td-sidebar-link__page>Zymbit Wallet Python SDK Tutorial</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsdigital-walletslip39-example-li><input type=checkbox id=m-tutorialsdigital-walletslip39-example-check>
<label for=m-tutorialsdigital-walletslip39-example-check><a href=/tutorials/digital-wallet/slip39-example/ title="SLIP39 and Shamir's Wallet Recovery Example" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsdigital-walletslip39-example><span class=td-sidebar-link__page>SLIP39 and Shamir's</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsdigital-walletoversight-example-li><input type=checkbox id=m-tutorialsdigital-walletoversight-example-check>
<label for=m-tutorialsdigital-walletoversight-example-check><a href=/tutorials/digital-wallet/oversight-example/ title="Creating an Oversight (Read Only) Wallet" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsdigital-walletoversight-example><span class=td-sidebar-link__page>Oversight Wallet</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsencrypt-rfs-li><input type=checkbox id=m-tutorialsencrypt-rfs-check>
<label for=m-tutorialsencrypt-rfs-check><a href=/tutorials/encrypt-rfs/ title="Encrypting Root File System with Zymbit Security Modules" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsencrypt-rfs><span class=td-sidebar-link__page>Encrypt Root File System</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialssensor-data-li><input type=checkbox id=m-tutorialssensor-data-check>
<label for=m-tutorialssensor-data-check><a href=/tutorials/sensor-data/ title="Encrypting & Decrypting Sensor Data on Disk" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialssensor-data><span class=td-sidebar-link__page>Encrypt Sensor Data</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child active-path" id=m-tutorialsaws-iot-li><input type=checkbox id=m-tutorialsaws-iot-check checked>
<label for=m-tutorialsaws-iot-check><a href=/tutorials/aws-iot/ title="AWS IoT Integrations & Client Certificates" class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-tutorialsaws-iot><span class=td-sidebar-link__section>Integrate Zymbit with AWS</span></a></label><ul class="pr-md-3 ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsaws-iotverify-sigs-li><input type=checkbox id=m-tutorialsaws-iotverify-sigs-check>
<label for=m-tutorialsaws-iotverify-sigs-check><a href=/tutorials/aws-iot/verify-sigs/ title="How to Verify Signatures against Public Key on AWS and Other Devices" class="align-left pl-0 active td-sidebar-link td-sidebar-link__page" id=m-tutorialsaws-iotverify-sigs><span class="td-sidebar-nav-active-item td-sidebar-link__page">Verify Signatures</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsaws-iottls-li><input type=checkbox id=m-tutorialsaws-iottls-check>
<label for=m-tutorialsaws-iottls-check><a href=/tutorials/aws-iot/tls/ title="AWS IoT - TLS Client Certificate Authentication" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsaws-iottls><span class=td-sidebar-link__page>Transport Level Security</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsaws-iotgreengrass-li><input type=checkbox id=m-tutorialsaws-iotgreengrass-check>
<label for=m-tutorialsaws-iotgreengrass-check><a href=/tutorials/aws-iot/greengrass/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsaws-iotgreengrass><span class=td-sidebar-link__page>Getting Started with AWS IoT Greengrass</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsaws-iotintegrate-li><input type=checkbox id=m-tutorialsaws-iotintegrate-check>
<label for=m-tutorialsaws-iotintegrate-check><a href=/tutorials/aws-iot/integrate/ title="How to Integrate Zymbit with AWS Credentials Provider" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsaws-iotintegrate><span class=td-sidebar-link__page>Integrate with AWS Credentials Provider</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsaws-iotjitr-li><input type=checkbox id=m-tutorialsaws-iotjitr-check>
<label for=m-tutorialsaws-iotjitr-check><a href=/tutorials/aws-iot/jitr/ title="AWS IoT - Just in Time Registration of Client Certificates using Lambda functions" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsaws-iotjitr><span class=td-sidebar-link__page>Just In Time Registration</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section with-child" id=m-tutorialsperimeter-detect-li><input type=checkbox id=m-tutorialsperimeter-detect-check>
<label for=m-tutorialsperimeter-detect-check><a href=/tutorials/perimeter-detect/ class="align-left pl-0 td-sidebar-link td-sidebar-link__section" id=m-tutorialsperimeter-detect><span class=td-sidebar-link__section>Perimeter Detect</span></a></label><ul class="pr-md-3 ul-3 foldable"><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsperimeter-detectzymkey4-li><input type=checkbox id=m-tutorialsperimeter-detectzymkey4-check>
<label for=m-tutorialsperimeter-detectzymkey4-check><a href=/tutorials/perimeter-detect/zymkey4/ title="Perimeter Detect: ZYMKEY4" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsperimeter-detectzymkey4><span class=td-sidebar-link__page>ZYMKEY4</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsperimeter-detecthsm4-li><input type=checkbox id=m-tutorialsperimeter-detecthsm4-check>
<label for=m-tutorialsperimeter-detecthsm4-check><a href=/tutorials/perimeter-detect/hsm4/ title="Perimeter Detect: HSM4" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsperimeter-detecthsm4><span class=td-sidebar-link__page>HSM4</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsperimeter-detecthsm6-li><input type=checkbox id=m-tutorialsperimeter-detecthsm6-check>
<label for=m-tutorialsperimeter-detecthsm6-check><a href=/tutorials/perimeter-detect/hsm6/ title="Perimeter Detect: HSM6" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsperimeter-detecthsm6><span class=td-sidebar-link__page>HSM6</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsperimeter-detectscm-li><input type=checkbox id=m-tutorialsperimeter-detectscm-check>
<label for=m-tutorialsperimeter-detectscm-check><a href=/tutorials/perimeter-detect/scm/ title="Perimeter Detect: SCM" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsperimeter-detectscm><span class=td-sidebar-link__page>SCM</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsperimeter-detectsen-li><input type=checkbox id=m-tutorialsperimeter-detectsen-check>
<label for=m-tutorialsperimeter-detectsen-check><a href=/tutorials/perimeter-detect/sen/ title="Perimeter Detect: Secure Edge Node" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsperimeter-detectsen><span class=td-sidebar-link__page>Secure Edge Node</span></a></label></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsperimeter-detectexamples-li><input type=checkbox id=m-tutorialsperimeter-detectexamples-check>
<label for=m-tutorialsperimeter-detectexamples-check><a href=/tutorials/perimeter-detect/examples/ title="Perimeter Detect Circuit Examples" class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsperimeter-detectexamples><span class=td-sidebar-link__page>CIRCUIT EXAMPLES</span></a></label></li></ul></li><li class="td-sidebar-nav__section-title td-sidebar-nav__section without-child" id=m-tutorialsprotokit-li><input type=checkbox id=m-tutorialsprotokit-check>
<label for=m-tutorialsprotokit-check><a href=/tutorials/protokit/ class="align-left pl-0 td-sidebar-link td-sidebar-link__page" id=m-tutorialsprotokit><span class=td-sidebar-link__page>ProtoKit5</span></a></label></li></ul></li></ul></li></ul></nav></div></aside><aside class="d-none d-xl-block col-xl-2 td-sidebar-toc d-print-none"><div class="td-page-meta ml-2 pb-1 pt-2 mb-0"></div><div class=td-toc><nav id=TableOfContents><ul><li><ul><li><a href=#introduction>Introduction</a></li></ul></li><li><a href=#prerequisites>Prerequisites</a><ul><li><a href=#simple-signature-validation-against-zymkey-public-key>Simple Signature Validation against Zymkey Public Key</a><ul><li><a href=#installing-python-ecdsa-library>Installing Python-Ecdsa library</a></li><li><a href=#simple-signature-verification-with-public-key>Simple Signature Verification with Public Key</a></li><li><a href=#signature-verification-on-another-device>Signature Verification on Another Device</a></li></ul></li><li><a href=#validation-of-sensor-data-signature-on-aws>Validation of Sensor Data Signature on AWS</a><ul><li><a href=#sending-encrypted-temperature-data-to-aws>Sending Encrypted Temperature Data to AWS</a></li><li><a href=#checking-data-is-being-published-to-aws-iot>Checking Data is being published to AWS IoT</a></li><li><a href=#verifying-signature-of-encrypted-data-with-zymkey-public-key-on-aws>Verifying Signature of Encrypted Data with Zymkey Public Key on AWS</a></li></ul></li></ul></li></ul></nav></div></aside><main class="col-12 col-md-8 col-xl-7 pl-md-5" role=main><nav aria-label=breadcrumb class="d-none d-md-block d-print-none"><ol class="breadcrumb spb-1"><li class=breadcrumb-item><a href=https://docs.zymbit.com/tutorials/>Tutorials</a></li><li class=breadcrumb-item><a href=https://docs.zymbit.com/tutorials/aws-iot/>Integrate Zymbit with AWS</a></li><li class="breadcrumb-item active" aria-current=page><a href=https://docs.zymbit.com/tutorials/aws-iot/verify-sigs/>Verify Signatures</a></li></ol></nav><div class=td-content><h1>How to Verify Signatures against Public Key on AWS and Other Devices</h1><header class=article-meta></header><h3 id=introduction>Introduction</h3><p>While all Zymbit modules make it trivial to verify data signed on the device with that module, verifying
the signature of data on other devices using the exportable public key requires a little more explanation.
Below is a simple code snippet to show how to verify the signature of data using Zymbit&rsquo;s Python API.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/python3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>zymkey</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># sign data</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=s1>&#39;hello world!&#39;</span>
</span></span><span class=line><span class=cl><span class=n>payload_sig</span> <span class=o>=</span> <span class=n>zymkey</span><span class=o>.</span><span class=n>client</span><span class=o>.</span><span class=n>sign</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># verify signature matches encrypted data</span>
</span></span><span class=line><span class=cl><span class=k>try</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>zymkey</span><span class=o>.</span><span class=n>client</span><span class=o>.</span><span class=n>verify</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>payload_sig</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Signature signed correctly by Zymbit module and matches payload.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=k>except</span> <span class=ne>Exception</span> <span class=k>as</span> <span class=n>e</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Signature invalid. Data not signed by Zymbit module private key.&#39;</span><span class=p>)</span>
</span></span></code></pre></div><p>Since the IoT environment is all about communication among many devices, we will demonstrate how to verify
a Zymbit module&rsquo;s ECDSA signature on other devices. We will do this using the public key corresponding to
the device&rsquo;s private key stored securely on the Zymbit module.</p><p>After showing how to do signature verification, we will demonstrate how this can be used in a practical
situation by collecting temperature data from a sensor and signing the data. We will then package the
data in JSON format - a standard format for data communication over the internet using strings.
This data will then be published to AWS IoT, where it will be routed via a Rule to a Lambda Function.
The Lambda Function will validate the data based on the public key.
From there you can route the data to any service you desire.</p><p>This post will demonstrate how to validate the signatures of all data sent to AWS before processing by
another service. All data published to AWS will be authenticated against a device certificate which
validates against the Zymbit module&rsquo;s private key without exporting said key. We will do this by making
HTTPS requests to AWS IoT using PyCurl. This serves as client authentication when connecting to AWS IoT.
All these examples will be done via Python using the Python-ECDSA library.</p><h2 id=prerequisites>Prerequisites</h2><ol><li>Follow the <a href=https://docs.zymbit.com/getting-started/>Getting Started guide</a> first, installing all baseline software.</li><li>If you wish to try Signature validation on AWS, you need a <a href=https://docs.zymbit.com/tutorials/aws-iot/tls/>valid device certificate</a> attached to your AWS account.</li><li>The device certificate needs to have a policy attached giving it permission to publish data.</li></ol><h3 id=simple-signature-validation-against-zymkey-public-key>Simple Signature Validation against Zymkey Public Key</h3><h4 id=installing-python-ecdsa-library>Installing Python-Ecdsa library</h4><p>For the verification of ECDSA-NIST256 signatures, we will be using the
<a href=https://github.com/warner/python-ecdsa>Python-ECDSA library</a>. Using Pip, the library can be
installed simply by running the following command:</p><pre><code>sudo pip3 install ecdsa
</code></pre><h4 id=simple-signature-verification-with-public-key>Simple Signature Verification with Public Key</h4><p>Below is a simple Python program demonstrating how to verify a Zymbit module signature with a
public key hosted on a device bound to that Zymbit module. The data passed to the ECDSA verifying
function is in bytearray format. The function is validating against the default signing hash
function Zymbit module uses, <code>sha256</code>, and returns a boolean indicating whether the signature
matches the public key and data. The public key for Zymkey is exported as bytearray using the
API function <code>get_public_key()</code>.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/python3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>zymkey</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>ecdsa</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Function to verify ECDSA signatures, all arguments must be in bytearray format.</span>
</span></span><span class=line><span class=cl><span class=c1># Validating against Zymkey signing&#39;s default hashing function, sha256 but this can be modified.</span>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>verify_ecdsa_signature</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>sig</span><span class=p>,</span> <span class=n>pub_key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>vk</span> <span class=o>=</span> <span class=n>ecdsa</span><span class=o>.</span><span class=n>VerifyingKey</span><span class=o>.</span><span class=n>from_string</span><span class=p>(</span><span class=n>pub_key</span><span class=p>,</span> <span class=n>ecdsa</span><span class=o>.</span><span class=n>NIST256p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>vk</span><span class=o>.</span><span class=n>verify</span><span class=p>(</span><span class=n>sig</span><span class=p>,</span> <span class=n>data</span><span class=p>,</span> <span class=n>hashfunc</span><span class=o>=</span><span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># exporting Zymkey public key as bytearray</span>
</span></span><span class=line><span class=cl>    <span class=n>pub_key</span> <span class=o>=</span> <span class=n>zymkey</span><span class=o>.</span><span class=n>client</span><span class=o>.</span><span class=n>get_public_key</span><span class=p>(</span><span class=n>slot</span><span class=o>=</span><span class=mi>0</span><span class=p>,</span> <span class=n>foreign</span><span class=o>=</span><span class=kc>False</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=s1>&#39;hello world!&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>data_bytes</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>payload_sig</span> <span class=o>=</span> <span class=n>zymkey</span><span class=o>.</span><span class=n>client</span><span class=o>.</span><span class=n>sign</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>verify_ecdsa_signature</span><span class=p>(</span><span class=n>data</span><span class=o>=</span><span class=n>data_bytes</span><span class=p>,</span> <span class=n>sig</span><span class=o>=</span><span class=n>payload_sig</span><span class=p>,</span> <span class=n>pub_key</span> <span class=o>=</span> <span class=n>pub_key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Signature matches data and public key pair.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Signature is invalid; it does not correspond to the public key.&#39;</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=signature-verification-on-another-device>Signature Verification on Another Device</h4><p>This next section will simulate signature verification on another device that receives
data in JSON format that has been signed with a Zymbit module. The public key is hard coded
into the program for the sake of a simple demonstration, but public key exchange between
devices is up to the discretion of the user.</p><p>The data payload and signature is passed in a JSON string in the format of a hex string.
Hex strings are simply representations of the underlying bytes in a human readable format.
The JSON data is represented below as the variable <strong>received_payload</strong>. For this example,
we are using <strong>received_payload</strong> data generated with the following example code on your
device with the Zymbit module.</p><p><strong>Export Public Key and Generate Example JSON Data for Validation</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/python3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>zymkey</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Get public key to give to remote</span>
</span></span><span class=line><span class=cl>    <span class=n>pub_key</span> <span class=o>=</span> <span class=n>zymkey</span><span class=o>.</span><span class=n>client</span><span class=o>.</span><span class=n>get_public_key</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;Public key:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>pub_key</span><span class=o>.</span><span class=n>hex</span><span class=p>())</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Create data then sign data</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=s1>&#39;hello world&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>data_bytes</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>signature</span> <span class=o>=</span> <span class=n>zymkey</span><span class=o>.</span><span class=n>client</span><span class=o>.</span><span class=n>sign</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Store data in a python dictionary that represents JSON. Data is originally in bytearray form</span>
</span></span><span class=line><span class=cl>    <span class=c1># but will be converted to hex_string</span>
</span></span><span class=line><span class=cl>    <span class=n>json_dictionary</span> <span class=o>=</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=n>data_bytes</span><span class=o>.</span><span class=n>hex</span><span class=p>(),</span>
</span></span><span class=line><span class=cl>        <span class=s1>&#39;signature&#39;</span><span class=p>:</span> <span class=n>signature</span><span class=o>.</span><span class=n>hex</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Convert python dictionary to JSON string format</span>
</span></span><span class=line><span class=cl>    <span class=n>received_payload</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>json_dictionary</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=s2>&#34;</span><span class=se>\n</span><span class=s2>JSON string:&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>received_payload</span><span class=p>)</span>
</span></span></code></pre></div><p><strong>Python Code to Verify Signature with Data Generated above</strong><br>Either substitute in your <code>pub_key</code> and <code>JSON data</code> from the previous example or use as is.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/python3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>zymkey</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>ecdsa</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>verify_ecdsa_signature</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>sig</span><span class=p>,</span> <span class=n>pub_key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>vk</span> <span class=o>=</span> <span class=n>ecdsa</span><span class=o>.</span><span class=n>VerifyingKey</span><span class=o>.</span><span class=n>from_string</span><span class=p>(</span><span class=n>pub_key</span><span class=p>,</span> <span class=n>ecdsa</span><span class=o>.</span><span class=n>NIST256p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>vk</span><span class=o>.</span><span class=n>verify</span><span class=p>(</span><span class=n>sig</span><span class=p>,</span> <span class=n>data</span><span class=p>,</span> <span class=n>hashfunc</span><span class=o>=</span><span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s2>&#34;__main__&#34;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># Zymkey public key in hex string format. Converted to byte_array, public key storage/exchange up to user. </span>
</span></span><span class=line><span class=cl>    <span class=n>pub_key</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=s1>&#39;6cd0b8b14963f6712877eb50a3f5afa9c0e39483e560f58eb795e634df53f399ba370dbceb71ea87cba5e2fca4f23ef73b8e683a9946758829f76521e7a19e5a&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=s1>&#39;&#39;&#39; 
</span></span></span><span class=line><span class=cl><span class=s1>    The variable received_payload will be the JSON string sent over to this device from the Zymkey.
</span></span></span><span class=line><span class=cl><span class=s1>    It contains 1.the data and 2.the signature for this data. See next code example to create an example.
</span></span></span><span class=line><span class=cl><span class=s1>    Here is how it will be formatted:
</span></span></span><span class=line><span class=cl><span class=s1>        &#34;{
</span></span></span><span class=line><span class=cl><span class=s1>            &#39;data&#39;: &#39;hex_string of data&#39;,
</span></span></span><span class=line><span class=cl><span class=s1>            &#39;signature&#39;: &#39;hex_string of signature;
</span></span></span><span class=line><span class=cl><span class=s1>        }&#34;
</span></span></span><span class=line><span class=cl><span class=s1>    &#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>received_payload</span> <span class=o>=</span> <span class=s1>&#39;{ &#34;data&#34;: &#34;68656c6c6f20776f726c64&#34;, &#34;signature&#34;: &#34;28953e99dcc7f7ebf2771acae9e996e45997a212f7deba04a5974d1db6651fc8c50f11a5e5ad24ef25bdf0dafbdb736513f618184505f469f126c7dd4557cade&#34; }&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Converting JSON string to Python dictionary for easier manipulation</span>
</span></span><span class=line><span class=cl>    <span class=n>payload_pydict</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>loads</span><span class=p>(</span><span class=n>received_payload</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Getting the hex_strings from the new Python dictionary</span>
</span></span><span class=line><span class=cl>    <span class=n>payload</span> <span class=o>=</span> <span class=n>payload_pydict</span><span class=p>[</span><span class=s1>&#39;data&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>    <span class=n>payload_sig</span> <span class=o>=</span> <span class=n>payload_pydict</span><span class=p>[</span><span class=s1>&#39;signature&#39;</span><span class=p>]</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Validating signature against public key and data, converting all hex_strings to bytearrays.</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>verify_ecdsa_signature</span><span class=p>(</span><span class=n>data</span><span class=o>=</span><span class=nb>bytearray</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>payload</span><span class=p>),</span> <span class=n>sig</span><span class=o>=</span><span class=nb>bytearray</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>payload_sig</span><span class=p>),</span> <span class=n>pub_key</span><span class=o>=</span><span class=n>pub_key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Signature matches data and public key pair.&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=s1>&#39;Signature is invalid; it does not correspond to the public key.&#39;</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=validation-of-sensor-data-signature-on-aws>Validation of Sensor Data Signature on AWS</h3><p>This example will generate randomly simulated temperature sensor data, package
the data into JSON format, and sign and send to send to AWS IoT.
The function <code>read_temp()</code> will return an array containing random values for
<code>temp_c</code> and <code>temp_f</code>.</p><div class="callout callout-notice"><div class=callout-heading><i class="callout-icon fas fa-flag"></i>
<span class=callout-title>Notice</span></div><div class=callout-body><p>If you wish to use an actual DS18B20 OneWire probe to collect temperature data,
you can follow the instructions at this link.</p><div class=resource-link><span class=block-label>Resources</span>
<a href=https://learn.adafruit.com/adafruits-raspberry-pi-lesson-11-ds18b20-temperature-sensing/hardware><h4 class=resource-link-title></h4><div class=resource-link-description>Using a DS18B20 OneWire Probe to Collect Temperature Data</div><p><span class=resource-link-read>Read article <i class="fas fa-chevron-double-right read-more-arrow"></i></span></a></p></div><p>Add this code and substitute for the <code>read_temp()</code> function in the example below.
This code collects Temperature data from the probe. It reads from a file that the probes deposit temperature data to. The function <code>read_temp()</code> will return an array containing <code>temp_c</code> and <code>temp_f</code>, whenever you need to read temperature from the probes. Substitute this next snippet of code if you are using a real probe.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/python3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>system</span><span class=p>(</span><span class=s1>&#39;modprobe w1-gpio&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>os</span><span class=o>.</span><span class=n>system</span><span class=p>(</span><span class=s1>&#39;modprobe w1-therm&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>base_dir</span> <span class=o>=</span> <span class=s1>&#39;/sys/bus/w1/devices/&#39;</span>
</span></span><span class=line><span class=cl><span class=n>device_folder</span> <span class=o>=</span> <span class=n>glob</span><span class=o>.</span><span class=n>glob</span><span class=p>(</span><span class=n>base_dir</span> <span class=o>+</span> <span class=s1>&#39;28*&#39;</span><span class=p>)[</span><span class=mi>0</span><span class=p>]</span>
</span></span><span class=line><span class=cl><span class=n>device_file</span> <span class=o>=</span> <span class=n>device_folder</span> <span class=o>+</span> <span class=s1>&#39;/w1_slave&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>read_temp</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># Supplies random temperature in Celsius and Farenheit for this example.</span>
</span></span><span class=line><span class=cl>    <span class=n>lines</span> <span class=o>=</span> <span class=n>read_temp_raw</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=n>lines</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span><span class=o>.</span><span class=n>strip</span><span class=p>()[</span><span class=o>-</span><span class=mi>3</span><span class=p>:]</span> <span class=o>!=</span> <span class=s1>&#39;YES&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mf>0.2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>lines</span> <span class=o>=</span> <span class=n>read_temp_raw</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>equals_pos</span> <span class=o>=</span> <span class=n>lines</span><span class=p>[</span><span class=mi>1</span><span class=p>]</span><span class=o>.</span><span class=n>find</span><span class=p>(</span><span class=s1>&#39;t=&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>if</span> <span class=n>equals_pos</span> <span class=o>!=</span> <span class=o>-</span><span class=mi>1</span><span class=p>:</span>
</span></span><span class=line><span class=cl>            <span class=n>temp_string</span> <span class=o>=</span> <span class=n>lines</span><span class=p>[</span><span class=mi>1</span><span class=p>][</span><span class=n>equals_pos</span><span class=o>+</span><span class=mi>2</span><span class=p>:]</span>
</span></span><span class=line><span class=cl>            <span class=n>temp_c</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>temp_string</span><span class=p>)</span> <span class=o>/</span> <span class=mf>1000.0</span>
</span></span><span class=line><span class=cl>            <span class=n>temp_f</span> <span class=o>=</span> <span class=n>temp_c</span> <span class=o>*</span> <span class=mf>9.0</span> <span class=o>/</span> <span class=mf>5.0</span> <span class=o>+</span> <span class=mf>32.0</span>
</span></span><span class=line><span class=cl>            <span class=k>return</span> <span class=n>temp_c</span><span class=p>,</span> <span class=n>temp_f</span>
</span></span></code></pre></div></div></div><p><strong>Collect data in JSON format, sign, and prepare for AWS</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/python3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>zymkey</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;
</span></span></span><span class=line><span class=cl><span class=s1>Note that JSON data needs to be in this format:
</span></span></span><span class=line><span class=cl><span class=s1>    &#34;{
</span></span></span><span class=line><span class=cl><span class=s1>        &#39;data&#39;: &#39;hex_string of data&#39;,
</span></span></span><span class=line><span class=cl><span class=s1>        &#39;signature&#39;: &#39;hex_string of signature;
</span></span></span><span class=line><span class=cl><span class=s1>    }&#34;
</span></span></span><span class=line><span class=cl><span class=s1>If you wish to use a different JSON format, you can always modify the lambda function.
</span></span></span><span class=line><span class=cl><span class=s1>&#39;&#39;&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>read_temp</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=c1># this provides simulated random data for the example</span>
</span></span><span class=line><span class=cl>    <span class=n>temp_c</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>100</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>temp_f</span> <span class=o>=</span> <span class=n>temp_c</span> <span class=o>*</span> <span class=mf>9.0</span> <span class=o>/</span> <span class=mf>5.0</span> <span class=o>+</span> <span class=mf>32.0</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>temp_c</span><span class=p>,</span> <span class=n>temp_f</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=n>temp_C</span><span class=p>,</span> <span class=n>temp_F</span> <span class=o>=</span> <span class=n>read_temp</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>deviceID</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>    <span class=n>myIP</span><span class=o>=</span> <span class=s1>&#39;192.168.100.100&#39;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Package the data in Python dictionary, then convert to JSON string.</span>
</span></span><span class=line><span class=cl>    <span class=n>data</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;temp_F&#39;</span><span class=p>:</span> <span class=n>temp_F</span><span class=p>,</span> <span class=s1>&#39;temp_C&#39;</span><span class=p>:</span> <span class=n>temp_C</span><span class=p>,</span> <span class=s1>&#39;deviceIP&#39;</span><span class=p>:</span> <span class=n>myIP</span><span class=p>,</span> <span class=s1>&#39;deviceID&#39;</span><span class=p>:</span> <span class=n>deviceID</span><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># sign the JSON string</span>
</span></span><span class=line><span class=cl>    <span class=n>json_str</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>json_str_bytes</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=p>(</span><span class=n>json_str</span><span class=p>,</span> <span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>signature</span> <span class=o>=</span> <span class=n>zymkey</span><span class=o>.</span><span class=n>client</span><span class=o>.</span><span class=n>sign</span><span class=p>(</span><span class=n>json_str</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Make a new dictionary to hold the hex_strings of the data and signature, and then turn into JSON</span>
</span></span><span class=line><span class=cl>    <span class=n>json_data</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>({</span><span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=n>json_str_bytes</span><span class=o>.</span><span class=n>hex</span><span class=p>(),</span> <span class=s1>&#39;signature&#39;</span><span class=p>:</span> <span class=n>signature</span><span class=o>.</span><span class=n>hex</span><span class=p>()})</span>
</span></span><span class=line><span class=cl>    <span class=nb>print</span><span class=p>(</span><span class=n>json_data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=c1># 10 seconds before reading temperature again</span>
</span></span><span class=line><span class=cl>    <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=sending-encrypted-temperature-data-to-aws>Sending Encrypted Temperature Data to AWS</h4><p>The AWS SDK doesn&rsquo;t support TLS connections over OpenSSL engines. Therefore, since
we keep the private key in the Zymbit module and not the file system, we will use CURL to make HTTPS requests
to AWS with the Zymbit module&rsquo;s embedded private key. We will be using PyCurl to do this programatically.</p><p><strong>Installing PyCurl</strong></p><p>PyCurl is simply a wrapper on the libssl library for C/C++. Install and
configure libssl library along with PyCurl:</p><pre><code>sudo apt-get install libcurl4-openssl-dev
sudo apt-get install libssl-dev
sudo pip install pycurl
</code></pre><p><strong>Registering Zymbit module device Certificate</strong></p><p>Connecting to and Publishing data to AWS IoT requries you to present a valid certificate that
has been regsitered with your AWS account. Instructions for that process is outlined
<a href=https://docs.zymbit.com/tutorials/aws-iot/tls/>here</a>. Make sure that the certificate
has a policy attached to allow data publication on AWS, if you follow the post completely this
should be done.</p><p><strong>Publishing data to AWS IoT</strong></p><p>Next we will publish the temperature data signed and saved from the last section to AWS IoT using PyCurl.
<strong>Make sure to find and change your AWS IoT endpoint in the following code. Information on how
to do this can be found in the tutorial linked above.</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/python3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>pycurl</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>random</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>time</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>zymkey</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>read_temp</span><span class=p>():</span>
</span></span><span class=line><span class=cl>    <span class=n>temp_c</span> <span class=o>=</span> <span class=nb>float</span><span class=p>(</span><span class=n>random</span><span class=o>.</span><span class=n>randint</span><span class=p>(</span><span class=mi>0</span><span class=p>,</span><span class=mi>100</span><span class=p>))</span>
</span></span><span class=line><span class=cl>    <span class=n>temp_f</span> <span class=o>=</span> <span class=n>temp_c</span> <span class=o>*</span> <span class=mf>9.0</span> <span class=o>/</span> <span class=mf>5.0</span> <span class=o>+</span> <span class=mf>32.0</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>temp_c</span><span class=p>,</span> <span class=n>temp_f</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>ZK_AWS_Publish</span><span class=p>(</span><span class=n>url</span><span class=p>,</span> <span class=n>post_field</span><span class=p>,</span> <span class=n>CA_Path</span><span class=p>,</span> <span class=n>Cert_Path</span><span class=p>,):</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span> <span class=o>=</span> <span class=n>pycurl</span><span class=o>.</span><span class=n>Curl</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Set Curl to use zymkey_ssl engine</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span><span class=o>.</span><span class=n>setopt</span><span class=p>(</span><span class=n>c</span><span class=o>.</span><span class=n>SSLENGINE</span><span class=p>,</span> <span class=s2>&#34;zymkey_ssl&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span><span class=o>.</span><span class=n>setopt</span><span class=p>(</span><span class=n>c</span><span class=o>.</span><span class=n>SSLVERSION</span><span class=p>,</span> <span class=n>c</span><span class=o>.</span><span class=n>SSLVERSION_TLSv1_2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>    <span class=c1># Set certificates for HTTPS connection</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span><span class=o>.</span><span class=n>setopt</span><span class=p>(</span><span class=n>c</span><span class=o>.</span><span class=n>SSLCERT</span><span class=p>,</span> <span class=n>Cert_Path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span><span class=o>.</span><span class=n>setopt</span><span class=p>(</span><span class=n>c</span><span class=o>.</span><span class=n>CAINFO</span><span class=p>,</span> <span class=n>CA_Path</span><span class=p>)</span>
</span></span><span class=line><span class=cl>	
</span></span><span class=line><span class=cl>    <span class=c1># Set endpoint and HTTPS type, here it is a POST</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span><span class=o>.</span><span class=n>setopt</span><span class=p>(</span><span class=n>c</span><span class=o>.</span><span class=n>URL</span><span class=p>,</span> <span class=n>url</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span><span class=o>.</span><span class=n>setopt</span><span class=p>(</span><span class=n>c</span><span class=o>.</span><span class=n>POSTFIELDS</span><span class=p>,</span> <span class=n>post_field</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Tell Curl to do client and host authentication</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span><span class=o>.</span><span class=n>setopt</span><span class=p>(</span><span class=n>c</span><span class=o>.</span><span class=n>SSL_VERIFYPEER</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span><span class=o>.</span><span class=n>setopt</span><span class=p>(</span><span class=n>c</span><span class=o>.</span><span class=n>SSL_VERIFYHOST</span><span class=p>,</span> <span class=mi>2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Turn on Verbose output and set key as placeholder, not actually a real file.</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span><span class=o>.</span><span class=n>setopt</span><span class=p>(</span><span class=n>c</span><span class=o>.</span><span class=n>VERBOSE</span><span class=p>,</span> <span class=mi>1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span><span class=o>.</span><span class=n>setopt</span><span class=p>(</span><span class=n>c</span><span class=o>.</span><span class=n>SSLKEYTYPE</span><span class=p>,</span> <span class=s2>&#34;ENG&#34;</span><span class=p>)</span>	
</span></span><span class=line><span class=cl>    <span class=n>c</span><span class=o>.</span><span class=n>setopt</span><span class=p>(</span><span class=n>c</span><span class=o>.</span><span class=n>SSLKEY</span><span class=p>,</span> <span class=s2>&#34;nonzymkey.key&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=n>c</span><span class=o>.</span><span class=n>perform</span><span class=p>()</span>
</span></span><span class=line><span class=cl>    <span class=n>c</span><span class=o>.</span><span class=n>close</span><span class=p>()</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>if</span> <span class=vm>__name__</span> <span class=o>==</span> <span class=s1>&#39;__main__&#39;</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=k>while</span> <span class=kc>True</span><span class=p>:</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>temp_C</span><span class=p>,</span> <span class=n>temp_F</span> <span class=o>=</span> <span class=n>read_temp</span><span class=p>()</span>
</span></span><span class=line><span class=cl>        <span class=n>deviceID</span> <span class=o>=</span> <span class=mi>1</span>
</span></span><span class=line><span class=cl>        <span class=n>myIP</span><span class=o>=</span> <span class=s1>&#39;192.168.100.100&#39;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Package the data in Python dictionary, then convert to JSON string.</span>
</span></span><span class=line><span class=cl>        <span class=n>data</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;temp_F&#39;</span><span class=p>:</span> <span class=n>temp_F</span><span class=p>,</span> <span class=s1>&#39;temp_C&#39;</span><span class=p>:</span> <span class=n>temp_C</span><span class=p>,</span> <span class=s1>&#39;deviceIP&#39;</span><span class=p>:</span> <span class=n>myIP</span><span class=p>,</span> <span class=s1>&#39;deviceID&#39;</span><span class=p>:</span> <span class=n>deviceID</span><span class=p>}</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># sign the JSON string</span>
</span></span><span class=line><span class=cl>        <span class=n>json_str</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>json_str_bytes</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=p>(</span><span class=n>json_str</span><span class=p>,</span> <span class=s1>&#39;utf-8&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=n>signature</span> <span class=o>=</span> <span class=n>zymkey</span><span class=o>.</span><span class=n>client</span><span class=o>.</span><span class=n>sign</span><span class=p>(</span><span class=n>json_str</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># Make a new dictionary to hold the hex_strings of the data and signature, and then turn into JSON</span>
</span></span><span class=line><span class=cl>        <span class=n>json_data</span> <span class=o>=</span> <span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>({</span><span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=n>json_str_bytes</span><span class=o>.</span><span class=n>hex</span><span class=p>(),</span> <span class=s1>&#39;signature&#39;</span><span class=p>:</span> <span class=n>signature</span><span class=o>.</span><span class=n>hex</span><span class=p>()})</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        <span class=c1># make sure and substitute you AWS endpoint as well as the paths to your certificate</span>
</span></span><span class=line><span class=cl>        <span class=n>AWS_ENDPOINT</span> <span class=o>=</span> <span class=s1>&#39;https://&lt;endpoint&gt;.amazonaws.com:8443/topics/pub_key_validate?qos=1&#39;</span>
</span></span><span class=line><span class=cl>        <span class=n>ZK_AWS_Publish</span><span class=p>(</span><span class=n>url</span><span class=o>=</span><span class=n>AWS_ENDPOINT</span><span class=p>,</span> <span class=n>post_field</span><span class=o>=</span><span class=n>json_data</span><span class=p>,</span> <span class=n>CA_Path</span><span class=o>=</span><span class=s1>&#39;/home/pi/verify-sig/AWS_CA.pem&#39;</span><span class=p>,</span> <span class=n>Cert_Path</span><span class=o>=</span><span class=s1>&#39;/home/pi/verify-sig/zymkey.crt&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=n>time</span><span class=o>.</span><span class=n>sleep</span><span class=p>(</span><span class=mi>10</span><span class=p>)</span>
</span></span></code></pre></div><h4 id=checking-data-is-being-published-to-aws-iot>Checking Data is being published to AWS IoT</h4><p>If all the previous steps have been done correctly, then you should be able to see the JSON string
you published on the AWS IoT console. It will be published to the topic <strong>pub_key_validate</strong>. This
is encoded in the endpoint link you can see in the code. The topic can be changed to whatever
you want. <strong>Here&rsquo;s how to check the data from the AWS IoT console</strong>:</p><ol><li>From the <strong>AWS console</strong>, select <strong>AWS IoT</strong>.</li><li>On the <strong>left hand bar</strong>, select <strong>Test</strong>. If MQTT Test is shown choose that.</li><li>Under <strong>subscription topic</strong>, write <strong>pub_key_validate</strong> and hit <strong>subscribe</strong>.</li><li>You should see your data being shown as it is being published.</li></ol><h4 id=verifying-signature-of-encrypted-data-with-zymkey-public-key-on-aws>Verifying Signature of Encrypted Data with Zymkey Public Key on AWS</h4><p><strong>Signature Verification Lambda function</strong>
An AWS Lambda function is code that runs on the cloud based on a configured trigger.
For this demonstration, the trigger will be data published to a specific topic, <code>pub_key_validate</code>,
on AWS IoT. From there the lambda function can validate signatures and talk with any other AWS service.</p><p>The function is written in terms of a <strong>lambda_handler</strong>. The <strong>event</strong> that it gets passed is
the JSON string published to AWS IoT. The Python lambda context automatically converts <strong>event</strong> from
a JSON string to Python dictionary.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/python3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>ecdsa</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>hashlib</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>verify_ecdsa_signature</span><span class=p>(</span><span class=n>data</span><span class=p>,</span> <span class=n>sig</span><span class=p>,</span> <span class=n>pub_key</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=n>vk</span> <span class=o>=</span> <span class=n>ecdsa</span><span class=o>.</span><span class=n>VerifyingKey</span><span class=o>.</span><span class=n>from_string</span><span class=p>(</span><span class=n>pub_key</span><span class=p>,</span> <span class=n>ecdsa</span><span class=o>.</span><span class=n>NIST256p</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=k>return</span> <span class=n>vk</span><span class=o>.</span><span class=n>verify</span><span class=p>(</span><span class=n>sig</span><span class=p>,</span> <span class=n>data</span><span class=p>,</span> <span class=n>hashfunc</span><span class=o>=</span><span class=n>hashlib</span><span class=o>.</span><span class=n>sha256</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=k>def</span> <span class=nf>lambda_handler</span><span class=p>(</span><span class=n>event</span><span class=p>,</span> <span class=n>context</span><span class=p>):</span>
</span></span><span class=line><span class=cl>    <span class=c1>#event is already converted from json-&gt;python dict</span>
</span></span><span class=line><span class=cl>    <span class=n>pub_key_byte</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=s1>&#39;9929a80b1d2e1543992dc767f394d1859bc33e9b241203f53473d859e1506f7ee5593b53a7fe7014aecc1f14886e1440e6bde27571c596a7ae3d1573e4122d90&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>byte_data</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>event</span><span class=p>[</span><span class=s1>&#39;data&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>byte_signature</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=o>.</span><span class=n>fromhex</span><span class=p>(</span><span class=n>event</span><span class=p>[</span><span class=s1>&#39;signature&#39;</span><span class=p>])</span>
</span></span><span class=line><span class=cl>    <span class=n>success_message</span> <span class=o>=</span> <span class=s1>&#39;Signature is authenticated against public key and data presented; it is valid.&#39;</span>
</span></span><span class=line><span class=cl>    <span class=n>fail_message</span> <span class=o>=</span> <span class=s1>&#39;Signature authentication has failed.&#39;</span>
</span></span><span class=line><span class=cl>    <span class=k>if</span> <span class=n>verify_ecdsa_signature</span><span class=p>(</span><span class=n>data</span><span class=o>=</span><span class=n>byte_data</span><span class=p>,</span> <span class=n>sig</span><span class=o>=</span><span class=n>byte_signature</span><span class=p>,</span> <span class=n>pub_key</span><span class=o>=</span><span class=n>pub_key_byte</span><span class=p>):</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>success_message</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>success_message</span>
</span></span><span class=line><span class=cl>    <span class=k>else</span><span class=p>:</span>
</span></span><span class=line><span class=cl>        <span class=nb>print</span><span class=p>(</span><span class=n>fail_message</span><span class=p>)</span>
</span></span><span class=line><span class=cl>        <span class=k>return</span> <span class=n>fail_message</span>
</span></span></code></pre></div><p><strong>Setting up Lambda function on AWS</strong></p><p>The lambda function is the python code that actually validates your Zymbit module signature. The data in
JSON format will be published to AWS IoT, and then routed to the lambda function. This is triggered
by an IoT rule. This basic lambda function will take the JSON string, validate the data using the
Python-ECDSA package, and then print and log its success status.</p><p>To set up the lambda function on AWS, we must first package the code with the ECDSA package, since
it is not part of the Python STL. To do this we zip up the lambda code with the ECDSA package in the
build directory.</p><p><strong>Packaging function with Python-ECDSA</strong></p><p>You can download a pre-configured zip file with Python-ECDSA included here. You can modify the
lambda function however you want here, but make sure you change the public key in particular if
you want to test out simple validation. <strong>If you change the lambda function make sure it is
changed inside the zip file.</strong></p><p>Otherwise just <strong>zip up the lambda function</strong> with the <strong>ecdsa directory</strong> you made in the
<strong>build directory</strong>. You can do this by first cloning the Github repository. Then build the
project by running this build command while inside the project directory.</p><pre><code> python setup.py build
</code></pre><p>Find the <strong>ecdsa</strong> directory inside the <strong>build</strong> directory, and zip up that directory with your code.</p><p><strong>Now, follow these steps to upload and activate your code on AWS:</strong></p><ol><li>From the <strong>AWS Console</strong>, select <strong>Lambda</strong></li><li>Select the orange <strong>Create function</strong> button</li><li>Choose to <strong>Author from Scratch</strong></li><li>Click <strong>next</strong>, the trigger will be configured later.</li><li>Give the Lambda function an appropriate <strong>Name</strong> and <strong>Description</strong>. Select <strong>Python 2.7</strong> as the <strong>Runtime</strong>.</li><li>Under <strong>Code entry type</strong>, choose to <strong>Upload a .ZIP file</strong></li><li>Upload your <strong>Zip file</strong>, making sure you have <strong>adjusted the public key for the lambda</strong>.</li><li>For <strong>Handler</strong> make sure to change it to <strong>Signature_Validation_Lambda.lambda_handler</strong></li><li>Choose to <strong>Create A Role</strong> if you don&rsquo;t already have one with basic logging privileges.</li><li>Give it an appropriate name and choose a <strong>policy template</strong>, picking <strong>basicedgelambda</strong>.</li><li>Finally, click <strong>next</strong> and then <strong>create function</strong>.</li></ol><p><strong>Testing Lambda function is working properly</strong></p><p>AWS&rsquo; lambda function can be given sample JSON input to test the function. So what we can do is
create data and sign it with Zymkey then convert it to a hex string locally, and then copy these
strings as input into the lambda function. If the public key in the lambda function you set up is
the complement to your Zymkey, it will validate correctly. Here we will use python to print out
the JSON string we need.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=ch>#!/usr/bin/python3</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>zymkey</span>
</span></span><span class=line><span class=cl><span class=kn>import</span> <span class=nn>json</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=nb>bytearray</span><span class=p>(</span><span class=s1>&#39;hello world~&#39;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>signature</span> <span class=o>=</span> <span class=n>zymkey</span><span class=o>.</span><span class=n>client</span><span class=o>.</span><span class=n>sign</span><span class=p>(</span><span class=n>data</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>python_dictionary</span> <span class=o>=</span> <span class=p>{</span><span class=s1>&#39;data&#39;</span><span class=p>:</span> <span class=n>data</span><span class=p>,</span> <span class=s1>&#39;signature&#39;</span><span class=p>:</span> <span class=n>signature</span><span class=p>}</span>
</span></span><span class=line><span class=cl><span class=nb>print</span><span class=p>(</span><span class=n>json</span><span class=o>.</span><span class=n>dumps</span><span class=p>(</span><span class=n>python_dictionary</span><span class=p>))</span>
</span></span></code></pre></div><p>Copy the output string, you will need to paste it onto the AWS test inputs. From the AWS Lambda
console, select your lambda function and click <strong>Test</strong>. Paste your JSON string as the input.
It should <strong>return and print a success message</strong>.</p><p><strong>Creating AWS IoT Rule</strong></p><p>The final step is to create a trigger for the Lambda function. Here we will make a Rule in AWS IoT,
so that all data published to pub_key_readings are routed to and trigger your Lambda function.</p><ol><li>From your <strong>AWS Console</strong>, click on the <strong>AWS IoT service</strong>.</li><li>On the left hand side, select <strong>Rules</strong> and then click the blue <strong>Create button</strong>.</li><li>Give it an <strong>appropriate Name and Description</strong>.</li><li>Using <strong>SQL version 2016-03-23</strong> use the following settings:</li></ol><pre tabindex=0><code>Attribute: *
Topic Filter: pub_key_reading
</code></pre><p>Set it to trigger a lambda function, and select the lambda function you created for signature validation.</p><p><strong>Seeing it all in Action</strong></p><p>The whole data pipeline goes like this:</p><p><strong>python collects data -> zymkey signs data -> python packages data to json -> pycurl publish
data to AWS IoT -> AWS IoT rule routs data and triggers lambda -> Lambda validates signature
and logs the success/failure.</strong></p><p>If you&rsquo;ve tested that data is being published and the lambda function is working properly, it should all work when you run the program to publish data.</p><p>From your AWS Console, select <strong>CloudWatch</strong>. Under <strong>Logs</strong> you shoud see something like
<strong>/aws/lambda/Signature_Validation</strong>. Check the logs for proper validation, if you have no
logs chances are your AWS IoT rule is not routing the data properly. If data is being published
and no logs appear, check your rule is configured properly.</p></div></main></div></div><footer class="bg-dark py-5 row d-print-none"><div class="container-fluid mx-sm-5"><div class=row><div class="col-6 col-sm-4 text-xs-center order-sm-2"></div><div class="col-6 col-sm-4 text-right text-xs-center order-sm-3"></div><div class="col-12 col-sm-4 text-center py-2 order-sm-2"></div></div></div></footer></div><script src=https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js integrity=sha384-9/reFTGAW83EW2RDu2S0VKaIzap3H66lZH81PoYlFhbGU+6BZp6G7niu735Sk7lN crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/js/bootstrap.min.js integrity=sha384-+YQ4JLhjyBLPDQt//I+STsc9iw4uQqACwlvpslubQzn4u2UU2UFM80nGisd026JF crossorigin=anonymous></script><script src=https://cdn.jsdelivr.net/npm/mermaid@8.11.2/dist/mermaid.min.js integrity=sha384-m8Pdaep6Qk8sW3J6XhPOiwUww3maU9HxZTLvEfSEB4e1UVvTdHyfJsYmEfYqvwLC crossorigin=anonymous></script><script src=/js/tabpane-persist.js></script><script src=/js/main.min.02544d8a35777f648f6dd431ca9785fc5c1877392035fcd33a35b212950bc741.js integrity="sha256-AlRNijV3f2SPbdQxypeF/FwYdzkgNfzTOjWyEpULx0E=" crossorigin=anonymous></script></body></html>